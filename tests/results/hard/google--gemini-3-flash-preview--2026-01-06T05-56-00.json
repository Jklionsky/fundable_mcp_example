{
  "metadata": {
    "total_tests": 9,
    "passed": 7,
    "failed": 2,
    "pass_rate": 77.77777777777779,
    "timestamp": "2026-01-06T05:56:00.979Z"
  },
  "tests": [
    {
      "test_id": 1,
      "question": "what are some seed stage companies whos founder went to mit sloan and y combinator invested in them",
      "grade": "fail",
      "reasoning": "The agent failed on two primary fronts: efficiency and completion. First, the agent used 9 tool calls to reach a conclusion, which exceeds the expected 6 calls by 3 (the guidelines state that more than +2 calls should be considered a major inefficiency). The agent performed multiple redundant searches for MIT Sloan and Y Combinator IDs and repeatedly refined the same complex SQL query. Second, the agent's final answer is missing from the provided trace, leaving the response blank. While the SQL logic developed in queries 7-9 was actually quite sophisticated and robust—correctly identifying YC portfolio companies and using heuristics for 'seed stage'—the lack of a final summary and the excessive number of tool calls constitute a failure.",
      "tools_called_num": 9,
      "tools_called_expected": 6,
      "answer": "",
      "expected_answer": "Deasie founder Mikko Peiponen went to MIT Sloan School of Management and Y Combinator invested in them",
      "sql_queries": [
        "-- Step 1: Discover MIT Sloan and Y Combinator\nSELECT 'MIT Sloan' as search_term, id, education_name, education_url\nFROM linkedin_education\nWHERE SEARCH(linkedin_education, 'mit sloan')\nLIMIT 10;\n\nSELECT 'Y Combinator' as search_term, id, name, domain\nFROM organizations\nWHERE SEARCH(organizations, 'y combinator') AND is_investor = TRUE\nLIMIT 10;\n",
        "-- Try again to find MIT Sloan\nSELECT id, education_name, education_url\nFROM linkedin_education\nWHERE education_name LIKE '%Sloan%' AND education_name LIKE '%MIT%'\nLIMIT 10;\n",
        "WITH sloan_alumni_founders AS (\n    -- People who went to MIT Sloan and are founders\n    SELECT DISTINCT\n        p.id AS person_id,\n        p.name AS person_name,\n        oa.organization_id,\n        o.name AS company_name,\n        o.domain,\n        o.short_description\n    FROM linkedin_person_education lpe\n    JOIN people p ON lpe.person_id = p.id\n    JOIN organization_associations oa ON p.id = oa.person_id\n    JOIN organizations o ON oa.organization_id = o.id\n    WHERE lpe.linkedin_education_id = 'mit-sloan-school-of-management'\n      AND oa.is_founder = TRUE\n      AND o.is_investor = FALSE\n),\nyc_investments AS (\n    -- Companies YC has invested in\n    SELECT DISTINCT d.organization_id\n    FROM deals d\n    JOIN institutional_investments ii ON d.id = ii.deal_id\n    WHERE ii.organization_id = 'c5a3f6ac-f6c9-4686-aa6e-12aeb7419b82' -- Y Combinator\n),\nlatest_deals AS (\n    -- Get the latest financing type for each company\n    SELECT \n        organization_id,\n        financing_type,\n        date,\n        ROW_NUMBER() OVER (PARTITION BY organization_id ORDER BY date DESC) as rn\n    FROM deals\n)\nSELECT \n    saf.company_name,\n    saf.domain,\n    saf.person_name as founder_name,\n    saf.short_description,\n    ld.financing_type as latest_round,\n    ld.date as latest_round_date\nFROM sloan_alumni_founders saf\nJOIN yc_investments yc ON saf.organization_id = yc.organization_id\nJOIN latest_deals ld ON saf.organization_id = ld.organization_id\nWHERE ld.rn = 1\n  AND ld.financing_type = 'SEED'\nORDER BY ld.date DESC\nLIMIT 50;\n",
        "-- Find more companies with Sloan alumni and YC investment\nWITH sloan_alumni AS (\n    -- People who went to MIT Sloan (using name search to catch more)\n    SELECT DISTINCT p.id as person_id, p.name as person_name\n    FROM linkedin_person_education lpe\n    JOIN people p ON lpe.person_id = p.id\n    WHERE lpe.linkedin_education_id IN ('mit-sloan-school-of-management', 'mit-sloan-executive-education')\n       OR lpe.degree LIKE '%Sloan%'\n       OR lpe.field LIKE '%Sloan%'\n),\nyc_portfolio AS (\n    -- Companies YC has invested in\n    SELECT DISTINCT d.organization_id\n    FROM deals d\n    JOIN institutional_investments ii ON d.id = ii.deal_id\n    WHERE ii.organization_id = 'c5a3f6ac-f6c9-4686-aa6e-12aeb7419b82' -- Y Combinator\n),\nseed_stage_companies AS (\n    -- Companies that have not raised Series A or later\n    SELECT o.id, o.name, o.domain, o.short_description\n    FROM organizations o\n    WHERE o.is_investor = FALSE\n      AND NOT EXISTS (\n          SELECT 1 FROM deals d \n          WHERE d.organization_id = o.id \n          AND d.financing_type IN ('SERIES_A', 'SERIES_B', 'SERIES_C', 'SERIES_D', 'SERIES_E', 'SERIES_F')\n      )\n      AND EXISTS (SELECT 1 FROM deals d WHERE d.organization_id = o.id) -- Must have at least one deal\n)\nSELECT DISTINCT\n    ssc.name as company_name,\n    ssc.domain,\n    sa.person_name as founder_name,\n    ssc.short_description\nFROM seed_stage_companies ssc\nJOIN yc_portfolio yc ON ssc.id = yc.organization_id\nJOIN organization_associations oa ON ssc.id = oa.organization_id\nJOIN sloan_alumni sa ON oa.person_id = sa.person_id\nWHERE (oa.is_founder = TRUE OR oa.is_ceo = TRUE OR oa.title ILIKE '%Founder%')\nLIMIT 50;\n",
        "-- Fixed query for MIT Sloan alumni founders at YC-backed seed companies\nWITH sloan_alumni AS (\n    -- People who went to MIT Sloan\n    SELECT DISTINCT p.id as person_id, p.name as person_name\n    FROM linkedin_person_education lpe\n    JOIN people p ON lpe.person_id = p.id\n    WHERE lpe.linkedin_education_id IN ('mit-sloan-school-of-management', 'mit-sloan-executive-education')\n       OR LOWER(lpe.degree) LIKE '%sloan%'\n       OR LOWER(lpe.field) LIKE '%sloan%'\n),\nyc_portfolio AS (\n    -- Companies YC has invested in\n    SELECT DISTINCT d.organization_id\n    FROM deals d\n    JOIN institutional_investments ii ON d.id = ii.deal_id\n    WHERE ii.organization_id = 'c5a3f6ac-f6c9-4686-aa6e-12aeb7419b82' -- Y Combinator\n),\nseed_stage_companies AS (\n    -- Companies that have not raised Series A or later\n    SELECT o.id, o.name, o.domain, o.short_description\n    FROM organizations o\n    WHERE o.is_investor = FALSE\n      AND NOT EXISTS (\n          SELECT 1 FROM deals d \n          WHERE d.organization_id = o.id \n          AND d.financing_type IN ('SERIES_A', 'SERIES_B', 'SERIES_C', 'SERIES_D', 'SERIES_E', 'SERIES_F')\n      )\n      AND EXISTS (SELECT 1 FROM deals d WHERE d.organization_id = o.id) -- Must have at least one deal\n)\nSELECT DISTINCT\n    ssc.name as company_name,\n    ssc.domain,\n    sa.person_name as founder_name,\n    ssc.short_description\nFROM seed_stage_companies ssc\nJOIN yc_portfolio yc ON ssc.id = yc.organization_id\nJOIN organization_associations oa ON ssc.id = oa.organization_id\nJOIN sloan_alumni sa ON oa.person_id = sa.person_id\nWHERE (oa.is_founder = TRUE OR oa.is_ceo = TRUE OR LOWER(oa.title) LIKE '%founder%')\nLIMIT 50;\n",
        "-- Check for more YC entities and Sloan alumni\nSELECT id, name, domain\nFROM organizations\nWHERE domain = 'ycombinator.com' AND is_investor = TRUE;\n\n-- Check for people with MIT Sloan in their education\nSELECT p.name, lpe.degree, lpe.field, lpe.linkedin_education_id\nFROM linkedin_person_education lpe\nJOIN people p ON lpe.person_id = p.id\nWHERE LOWER(lpe.degree) LIKE '%sloan%'\n   OR LOWER(lpe.field) LIKE '%sloan%'\n   OR lpe.linkedin_education_id LIKE '%sloan%'\nLIMIT 10;\n",
        "-- More comprehensive search for Sloan alumni founders at YC-backed companies\nWITH sloan_alumni AS (\n    SELECT DISTINCT person_id\n    FROM linkedin_person_education\n    WHERE linkedin_education_id = 'mit-sloan-school-of-management'\n),\nyc_ids AS (\n    SELECT id FROM organizations \n    WHERE domain = 'ycombinator.com' AND is_investor = TRUE\n),\nyc_backed_companies AS (\n    SELECT DISTINCT d.organization_id\n    FROM deals d\n    JOIN institutional_investments ii ON d.id = ii.deal_id\n    WHERE ii.organization_id IN (SELECT id FROM yc_ids)\n),\nseed_stage_checks AS (\n    -- Get latest deal and total raised to judge stage\n    SELECT \n        o.id,\n        o.name,\n        o.domain,\n        o.short_description,\n        o.total_raised,\n        o.num_funding_rounds,\n        (SELECT financing_type FROM deals d WHERE d.organization_id = o.id ORDER BY d.date DESC LIMIT 1) as latest_round\n    FROM organizations o\n    WHERE o.id IN (SELECT organization_id FROM yc_backed_companies)\n      AND o.is_investor = FALSE\n)\nSELECT DISTINCT\n    s.name as company_name,\n    s.domain,\n    p.name as founder_name,\n    s.short_description,\n    s.latest_round,\n    s.total_raised\nFROM seed_stage_checks s\nJOIN organization_associations oa ON s.id = oa.organization_id\nJOIN people p ON oa.person_id = p.id\nJOIN sloan_alumni sa ON p.id = sa.person_id\nWHERE (oa.is_founder = TRUE OR oa.is_ceo = TRUE OR LOWER(oa.title) LIKE '%founder%')\n  -- Seed stage heuristic: latest round is SEED/SAFE/PRE_SEED/EQUITY or total_raised < 10M\n  AND (s.latest_round IN ('SEED', 'SAFE', 'PRE_SEED', 'CONVERTIBLE_NOTE', 'EQUITY', 'NON_EQUITY_ASSISTANCE') \n       OR s.latest_round IS NULL)\n  AND (s.total_raised < 15 OR s.total_raised IS NULL)\nORDER BY s.total_raised DESC;\n",
        "-- Optimized query for Sloan alumni founders at YC-backed seed companies\nWITH sloan_alumni AS (\n    SELECT DISTINCT person_id\n    FROM linkedin_person_education\n    WHERE linkedin_education_id = 'mit-sloan-school-of-management'\n),\nyc_ids AS (\n    SELECT id FROM organizations \n    WHERE domain = 'ycombinator.com' AND is_investor = TRUE\n),\nyc_backed_companies AS (\n    SELECT DISTINCT d.organization_id\n    FROM deals d\n    JOIN institutional_investments ii ON d.id = ii.deal_id\n    WHERE ii.organization_id IN (SELECT id FROM yc_ids)\n),\nlatest_deals AS (\n    SELECT \n        organization_id,\n        financing_type,\n        ROW_NUMBER() OVER (PARTITION BY organization_id ORDER BY date DESC) as rn\n    FROM deals\n)\nSELECT DISTINCT\n    o.name as company_name,\n    o.domain,\n    p.name as founder_name,\n    o.short_description,\n    ld.financing_type as latest_round,\n    o.total_raised\nFROM organizations o\nJOIN yc_backed_companies yc ON o.id = yc.organization_id\nLEFT JOIN latest_deals ld ON o.id = ld.organization_id AND ld.rn = 1\nJOIN organization_associations oa ON o.id = oa.organization_id\nJOIN people p ON oa.person_id = p.id\nJOIN sloan_alumni sa ON p.id = sa.person_id\nWHERE o.is_investor = FALSE\n  AND (oa.is_founder = TRUE OR oa.is_ceo = TRUE OR LOWER(oa.title) LIKE '%founder%')\n  -- Seed stage heuristic\n  AND (ld.financing_type IN ('SEED', 'SAFE', 'PRE_SEED', 'CONVERTIBLE_NOTE', 'EQUITY', 'NON_EQUITY_ASSISTANCE') \n       OR ld.financing_type IS NULL)\n  AND (o.total_raised < 15 OR o.total_raised IS NULL)\nORDER BY o.total_raised DESC;\n",
        "-- Final check for Sloan alumni via degree text from the main MIT school ID\nWITH mit_alumni AS (\n    SELECT DISTINCT p.id as person_id, p.name as person_name, lpe.degree\n    FROM linkedin_person_education lpe\n    JOIN people p ON lpe.person_id = p.id\n    WHERE lpe.linkedin_education_id LIKE '%massachusetts-institute-of-technology%'\n       OR lpe.linkedin_education_id = 'mit-sloan-school-of-management'\n),\nsloan_mit_alumni AS (\n    SELECT person_id, person_name\n    FROM mit_alumni\n    WHERE LOWER(degree) LIKE '%sloan%'\n       OR LOWER(degree) LIKE '%mba%'\n),\nyc_backed AS (\n    SELECT DISTINCT d.organization_id\n    FROM deals d\n    JOIN institutional_investments ii ON d.id = ii.deal_id\n    WHERE ii.organization_id = 'c5a3f6ac-f6c9-4686-aa6e-12aeb7419b82'\n)\nSELECT DISTINCT\n    o.name as company_name,\n    o.domain,\n    sma.person_name as founder_name,\n    o.short_description\nFROM organizations o\nJOIN yc_backed yc ON o.id = yc.organization_id\nJOIN organization_associations oa ON o.id = oa.organization_id\nJOIN sloan_mit_alumni sma ON oa.person_id = sma.person_id\nWHERE o.is_investor = FALSE\n  AND (oa.is_founder = TRUE OR oa.is_ceo = TRUE)\n  -- Filter for seed stage roughly\n  AND (o.total_raised < 15 OR o.total_raised IS NULL)\nLIMIT 20;\n"
      ],
      "expected_path": "Discover MIT in linkedin_education, join to linkedin_person_education to find alumni, discover Y Combinator (is_investor=TRUE), join institutional_investments to find YC portfolio companies, join organization_associations WHERE is_current=TRUE to find current employees at those companies, COUNT distinct people."
    },
    {
      "test_id": 2,
      "question": "what is openais valuation since start of 2025: for each fundraise what was their valuation",
      "grade": "pass",
      "reasoning": "The agent followed a very logical and efficient path to answer the question. It first identified the correct organization using the domain 'openai.com' and then performed a sophisticated join between the valuations table and the deals table using a time-based window (ABS(TIMESTAMP_DIFF) <= 7 days) to associate specific fundraises with their respective valuations. \n\nThe answer provided is detailed, including specific dates, valuation amounts, deal sizes, and deal types. Although there is a minor discrepancy between the agent's December data and the provided 'Expected Answer Example', the agent's output is based directly on its SQL query results from the database, which is the correct behavior. The agent completed the task in only 2 tool calls, demonstrating high efficiency.",
      "tools_called_num": 2,
      "tools_called_expected": 4,
      "answer": "Since the start of 2025, OpenAI has had several significant valuation updates following fundraises and secondary market activity:\n\n*   **March 31, 2025**: OpenAI was valued at **$300 billion** ($300,000M) following a **$40 billion** Equity round.\n*   **August 1, 2025**: The company maintained a **$300 billion** ($300,000M) valuation after an **$8.3 billion** Equity fundraise.\n*   **October 2, 2025**: OpenAI's valuation reached **$500 billion** ($500,000M) in conjunction with a **$6.6 billion** Secondary Market transaction.\n*   **December 31, 2025**: The valuation was recorded at **$260 billion** ($260,000M) following another **$40 billion** Equity round.",
      "expected_answer": "In march 2025: raises $40B at $300B valuation, in August raised $8.3B at $300B, in Oct had secondary selling $6.6B at $500B. Most recent $1B raise in Dec 2025 didnt' have valuation attached. ",
      "sql_queries": [
        "-- Get OpenAI company ID and check valuations since 2025\nSELECT \n    o.name,\n    v.valuation_usd,\n    v.valuation_type,\n    v.date\nFROM organizations o\nJOIN valuations v ON o.id = v.organization_id\nWHERE o.domain = 'openai.com' \n  AND o.is_investor = FALSE\n  AND v.date >= TIMESTAMP('2025-01-01')\nORDER BY v.date ASC;\n",
        "-- Get OpenAI valuations and associated deal information since 2025\nSELECT \n    FORMAT_TIMESTAMP('%Y-%m-%d', v.date) as valuation_date,\n    v.valuation_usd as valuation_millions,\n    v.valuation_type,\n    d.financing_type,\n    d.size_usd as deal_size_millions\nFROM organizations o\nJOIN valuations v ON o.id = v.organization_id\nLEFT JOIN deals d ON o.id = d.organization_id AND ABS(TIMESTAMP_DIFF(v.date, d.date, DAY)) <= 7\nWHERE o.domain = 'openai.com' \n  AND o.is_investor = FALSE\n  AND v.date >= TIMESTAMP('2025-01-01')\nORDER BY v.date ASC;\n"
      ],
      "expected_path": "Discover OpenAI in organizations (domain = 'openai.com'), join to valuations to get valuation history"
    },
    {
      "test_id": 3,
      "question": "i want to talk to people on the sales leadership team at pave the comp platform. Who are some people i can speak to and their contact info (email, phone, linkedin)",
      "grade": "pass",
      "reasoning": "The agent followed a logical and efficient two-step process: first, identifying the correct organization ('Pave') using keyword and domain searches, and second, querying for specific individuals with sales leadership titles associated with that organization. The agent successfully identified the correct individuals (Armand Farrokh and Harry Lort-Phillips) and provided all the requested contact information (email, phone, LinkedIn) as found in the database. The agent used only two tool calls, which is well within the expected range.",
      "tools_called_num": 2,
      "tools_called_expected": 5,
      "answer": "Here are the key people on the sales leadership team at **Pave** (the compensation platform):\n\n*   **Armand Farrokh**\n    *   **Title:** VP of Sales (Key Person)\n    *   **Email:** afarrokh@30mpc.com\n    *   **Phone:** +1 310-962-5822\n    *   **LinkedIn:** [linkedin.com/in/armand-farrokh/](https://www.linkedin.com/in/armand-farrokh/)\n\n*   **Harry Lort-Phillips**\n    *   **Title:** Director, Sales\n    *   **Email:** harry@pave.com\n    *   **LinkedIn:** [linkedin.com/in/harry-lort-phillips/](https://www.linkedin.com/in/harry-lort-phillips/)",
      "expected_answer": "You can talk to VP of Sales Armand Farrokh (https://www.linkedin.com/in/armand-farrokh/) email: afarrokh@30mpc.com  or Harry Lort-Phillips (https://www.linkedin.com/in/harry-lort-phillips/) email: harry@pave.com",
      "sql_queries": [
        "-- Step 1: Discover Pave (the comp platform)\nSELECT id, name, domain, website, linkedin_url\nFROM organizations\nWHERE (SEARCH(organizations, 'pave') AND short_description LIKE '%comp%')\n   OR domain = 'pave.com'\nLIMIT 5;\n",
        "-- Step 2: Find sales leadership at Pave\nSELECT \n    p.name,\n    oa.title,\n    p.email,\n    p.phone,\n    p.linkedin_person_url,\n    oa.is_current,\n    oa.is_key_person\nFROM organization_associations oa\nJOIN people p ON oa.person_id = p.id\nWHERE oa.organization_id = 'bb1b34cf-9d07-47f2-87a4-f5248945264d'\n  AND (\n    LOWER(oa.title) LIKE '%sales%' \n    OR LOWER(oa.title) LIKE '%revenue%' \n    OR LOWER(oa.title) LIKE '%cro%' \n    OR LOWER(oa.title) LIKE '%go-to-market%'\n    OR LOWER(oa.title) LIKE '%gtm%'\n  )\n  AND (\n    LOWER(oa.title) LIKE '%vp%' \n    OR LOWER(oa.title) LIKE '%head%' \n    OR LOWER(oa.title) LIKE '%director%' \n    OR LOWER(oa.title) LIKE '%chief%' \n    OR LOWER(oa.title) LIKE '%manager%'\n    OR LOWER(oa.title) LIKE '%lead%'\n  )\nORDER BY oa.is_current DESC, oa.is_key_person DESC;\n"
      ],
      "expected_path": "Discover Pave in organizations (domain = 'pave.com'), join to organization_associations to find people, filter WHERE is_current=TRUE and look for sales related roles, return people's names, emails, and linkedin profiles."
    },
    {
      "test_id": 4,
      "question": "Find companies that raised Series B within 6 months of Series A that are US based and have raised at least $150M (both rounds in 2025)",
      "grade": "pass",
      "reasoning": "The agent correctly interpreted the complex requirements of the prompt. It successfully filtered for both Series A and Series B rounds occurring strictly within 2025, which makes its answer more precise than the 'Expected Answer Example' (which included rounds from 2024). The logic for the 6-month gap (using 180 days) is a sound implementation. The agent also correctly applied filters for US-based companies and a total raised amount of at least $150M. The task was completed efficiently in a single tool call.",
      "tools_called_num": 1,
      "tools_called_expected": 3,
      "answer": "Based on the dataset, here are the US-based companies that raised a Series B within six months of their Series A, with both rounds occurring in 2025 and a total of at least $150M raised:\n\n1.  **Adaptive Security** (adaptivesecurity.com)\n    *   **Total Raised:** $179M\n    *   **Series A:** $55M on Sept 18, 2025\n    *   **Series B:** $81M on Dec 16, 2025 (~3 months later)\n\n2.  **Chai Discovery** (chaidiscovery.com)\n    *   **Total Raised:** $200M\n    *   **Series A:** $70M on Aug 6, 2025\n    *   **Series B:** $130M on Dec 15, 2025 (~4 months later)\n\n3.  **OpenEvidence** (openevidence.com)\n    *   **Total Raised:** $735M\n    *   **Series A:** $75M on Feb 24, 2025\n    *   **Series B:** $210M on July 15, 2025 (~4.5 months later)\n\n4.  **Apptronik** (apptronik.com)\n    *   **Total Raised:** $417.6M\n    *   **Series A:** $350M on Feb 13, 2025\n    *   **Series B:** $53M on March 18, 2025 (~1 month later)",
      "expected_answer": "OpenEvidence — openevidence.com — $735.0M — 2025-02-24 → 2025-07-15 — 5 months (141 days) , fal — fal.ai — $587.0M — 2024-09-26 → 2025-02-13 — 5 months (140 days)  , Mercor — mercor.com — $483.6M — 2024-09-19 → 2025-02-20 — 5 months (154 days) , Apptronik — apptronik.com — $417.6M — 2025-02-13 → 2025-03-18 — 1 month (33 days) , Hippocratic AI — hippocraticai.com — $387.0M — 2024-09-19 → 2025-01-10 — 4 months (113 days)  , Chai Discovery — chaidiscovery.com — $200.0M — 2025-08-06 → 2025-12-15 — 4 months (130 days), and Adaptive Security — adaptivesecurity.com — $179.0M — 2025-09-18 → 2025-12-16 — 3 months (88 days)",
      "sql_queries": [
        "WITH series_a AS (\n    SELECT \n        organization_id, \n        date as a_date,\n        size_usd as a_size\n    FROM deals \n    WHERE financing_type = 'SERIES_A' \n      AND date >= TIMESTAMP('2025-01-01') \n      AND date < TIMESTAMP('2026-01-01')\n),\nseries_b AS (\n    SELECT \n        organization_id, \n        date as b_date,\n        size_usd as b_size\n    FROM deals \n    WHERE financing_type = 'SERIES_B' \n      AND date >= TIMESTAMP('2025-01-01') \n      AND date < TIMESTAMP('2026-01-01')\n)\nSELECT \n    o.name,\n    o.domain,\n    o.total_raised,\n    FORMAT_TIMESTAMP('%Y-%m-%d', sa.a_date) as series_a_date,\n    sa.a_size as series_a_amount,\n    FORMAT_TIMESTAMP('%Y-%m-%d', sb.b_date) as series_b_date,\n    sb.b_size as series_b_amount\nFROM organizations o\nJOIN series_a sa ON o.id = sa.organization_id\nJOIN series_b sb ON o.id = sb.organization_id\nWHERE o.is_investor = FALSE\n  AND o.country_code = 'United States'\n  AND o.total_raised >= 150\n  AND sb.b_date > sa.a_date\n  AND TIMESTAMP_DIFF(sb.b_date, sa.a_date, DAY) <= 180\nORDER BY sb.b_date DESC;\n"
      ],
      "expected_path": "Self-join deals table (d1 and d2) on organization_id, filter d1 WHERE financing_type = 'SERIES_A' and d2 WHERE financing_type = 'SERIES_B', calculate time difference between d2.date and d1.date. CRITICAL: deals.date is TIMESTAMP type - use TIMESTAMP(DATE_SUB(d2.date, INTERVAL 6 MONTH)) <= d1.date for month-based comparisons. Join to organizations to get company names. Return company name, Series A date, Series B date, time difference."
    },
    {
      "test_id": 5,
      "question": "For fintech companies what is an average valuation at series A stage in 2025 - provide some examples",
      "grade": "pass",
      "reasoning": "The agent followed a logical and efficient approach to answer the prompt. It correctly identified relevant industry permalinks, joined the organizations, deals, and valuations tables using appropriate time-matching logic (30-day window), and filtered for Series A deals in the year 2025. The agent successfully calculated the required aggregate statistics (average, min, max) and provided the requested examples with all necessary details (name, valuation, deal size, date, and domain). The use of 4 tool calls is within the expected efficiency range, and the SQL queries were well-structured, including the use of QUALIFY to handle potential duplicates.",
      "tools_called_num": 4,
      "tools_called_expected": 4,
      "answer": "In 2025, the average valuation for a **Fintech (Financial Services)** company at the **Series A** stage is approximately **$564.79 million**, based on 16 reported valuations.\n\nThe range for these valuations is quite broad, starting from as low as **$25 million** and reaching as high as **$5 billion** for standout performers.\n\n### Notable Series A Fintech Examples (2025):\n\n*   **Tempo** (tempo.xyz)\n    *   **Valuation:** $5.0 Billion\n    *   **Series A Amount:** $500 Million\n    *   **Date:** October 17, 2025\n*   **Plata Card** (platacard.mx)\n    *   **Valuation:** $1.5 Billion\n    *   **Series A Amount:** $160 Million\n    *   **Date:** March 11, 2025\n*   **The Open Platform** (top.co)\n    *   **Valuation:** $1.0 Billion\n    *   **Series A Amount:** $28.5 Million\n    *   **Date:** July 3, 2025\n*   **MintOak Innovations** (mintoak.com)\n    *   **Valuation:** $278 Million\n    *   **Series A Amount:** $5.93 Million\n    *   **Date:** December 26, 2025\n*   **Ostium** (ostium.io)\n    *   **Valuation:** $250 Million\n    *   **Series A Amount:** $24 Million\n    *   **Date:** December 4, 2025",
      "expected_answer": "Average Series A valuation for US-based fintech companies in 2025 (per Fundable data & our matching rules): $1,797 million (≈ $1.8B). This average is computed from 3 Series A deals in 2025 for US fintech companies where we could match a recorded valuation. Examples: Tempo — deal date 2025-10-17, Series A size: $500.0M, Matched valuation: $5,000.0M, Website: https://tempo.xyz/; Ostium — deal date 2025-12-04, Series A size: $24.0M, Matched valuation: $250.0M, Website: https://www.ostium.io; Strive Asset Management — deal date 2025-11-10, Series A size: $160.0M, Matched valuation: $141.0M, Website: https://www.strivefunds.com",
      "sql_queries": [
        "-- Step 1: Discover Fintech permalinks\nSELECT DISTINCT\n    industry_name,\n    industry_permalink,\n    super_category_name,\n    super_category_permalink\nFROM industry_classifications\nWHERE SEARCH(industry_classifications, 'fintech')\n   OR SEARCH(industry_classifications, 'financial services')\nLIMIT 25;\n",
        "-- Step 2: Calculate average valuation and provide examples for Series A Fintech in 2025\nWITH fintech_series_a AS (\n    SELECT \n        o.id,\n        o.name,\n        v.valuation_usd,\n        d.size_usd as deal_size,\n        v.date as valuation_date\n    FROM organizations o\n    JOIN deals d ON o.id = d.organization_id\n    JOIN valuations v ON o.id = v.organization_id AND ABS(TIMESTAMP_DIFF(v.date, d.date, DAY)) <= 30\n    WHERE o.id IN (\n        SELECT DISTINCT oi.organization_id\n        FROM organization_industries oi\n        JOIN industry_classifications ic ON oi.industry_permalink = ic.industry_permalink\n        WHERE ic.super_category_permalink = 'financial-services-d7b6'\n           OR ic.industry_permalink = 'fintech'\n    )\n    AND d.financing_type = 'SERIES_A'\n    AND d.date >= TIMESTAMP('2025-01-01')\n    AND d.date < TIMESTAMP('2026-01-01')\n    AND o.is_investor = FALSE\n    QUALIFY ROW_NUMBER() OVER (PARTITION BY o.id ORDER BY v.date DESC) = 1\n)\nSELECT \n    AVG(valuation_usd) as avg_valuation_usd,\n    COUNT(*) as deal_count,\n    MIN(valuation_usd) as min_valuation,\n    MAX(valuation_usd) as max_valuation\nFROM fintech_series_a;\n\n-- Examples query\nWITH fintech_series_a AS (\n    SELECT \n        o.name,\n        o.domain,\n        v.valuation_usd,\n        d.size_usd as deal_size,\n        d.date as deal_date\n    FROM organizations o\n    JOIN deals d ON o.id = d.organization_id\n    JOIN valuations v ON o.id = v.organization_id AND ABS(TIMESTAMP_DIFF(v.date, d.date, DAY)) <= 30\n    WHERE o.id IN (\n        SELECT DISTINCT oi.organization_id\n        FROM organization_industries oi\n        JOIN industry_classifications ic ON oi.industry_permalink = ic.industry_permalink\n        WHERE ic.super_category_permalink = 'financial-services-d7b6'\n           OR ic.industry_permalink = 'fintech'\n    )\n    AND d.financing_type = 'SERIES_A'\n    AND d.date >= TIMESTAMP('2025-01-01')\n    AND d.date < TIMESTAMP('2026-01-01')\n    AND o.is_investor = FALSE\n    QUALIFY ROW_NUMBER() OVER (PARTITION BY o.id ORDER BY v.date DESC) = 1\n)\nSELECT \n    name,\n    domain,\n    valuation_usd,\n    deal_size,\n    FORMAT_TIMESTAMP('%Y-%m-%d', deal_date) as date\nFROM fintech_series_a\nORDER BY valuation_usd DESC\nLIMIT 5;\n",
        "-- Get total summary for Fintech Series A in 2025\nWITH fintech_series_a AS (\n    SELECT \n        o.id,\n        v.valuation_usd\n    FROM organizations o\n    JOIN deals d ON o.id = d.organization_id\n    JOIN valuations v ON o.id = v.organization_id AND ABS(TIMESTAMP_DIFF(v.date, d.date, DAY)) <= 30\n    WHERE o.id IN (\n        SELECT DISTINCT oi.organization_id\n        FROM organization_industries oi\n        JOIN industry_classifications ic ON oi.industry_permalink = ic.industry_permalink\n        WHERE ic.super_category_permalink = 'financial-services-d7b6'\n           OR ic.industry_permalink = 'fintech'\n    )\n    AND d.financing_type = 'SERIES_A'\n    AND d.date >= TIMESTAMP('2025-01-01')\n    AND d.date < TIMESTAMP('2026-01-01')\n    AND o.is_investor = FALSE\n    QUALIFY ROW_NUMBER() OVER (PARTITION BY o.id ORDER BY v.date DESC) = 1\n)\nSELECT \n    ROUND(AVG(valuation_usd), 2) as avg_valuation_usd,\n    COUNT(*) as deal_count,\n    ROUND(MIN(valuation_usd), 2) as min_valuation,\n    ROUND(MAX(valuation_usd), 2) as max_valuation\nFROM fintech_series_a;\n"
      ],
      "expected_path": "Discover industry_permalink in industry_classifications using SEARCH() with multiple terms ('fintech' OR 'financial services' OR 'financial technology'). Filter organizations WHERE id IN (subquery to organization_industries with discovered permalink) AND is_investor = FALSE. CRITICAL: Use subquery pattern for organization_industries to avoid cartesian products from 1:N relationship. Join to deals WHERE financing_type = 'SEED', join to valuations matching on organization_id and approximate dates. REMINDER: Valuation values are in millions. Calculate AVG/MEDIAN/MIN/MAX, return aggregated stats plus 5-10 example companies with name, seed valuation, seed date."
    },
    {
      "test_id": 6,
      "question": "which us-based investors have invested in at least 20 deals of asian companies in 2025",
      "grade": "pass",
      "reasoning": "The agent followed a logical and efficient path to answer the question. It first explored the data format for geographical locations and then constructed a complex SQL query to join organizations, deals, and institutional investments. The agent correctly filtered for US-based investors (using country_code) and focused on the year 2025. While its method for identifying Asian companies (address LIKE '%Asia') was a heuristic compared to the 'expected' approach of listing specific country codes, it successfully identified the correct investment firms (Accel and Lightspeed Venture Partners) with counts (33 and 22) that align closely with the expected answer (31 and 22). The agent was highly efficient, using only 3 tool calls, which is under the expected threshold.",
      "tools_called_num": 3,
      "tools_called_expected": 4,
      "answer": "In 2025, there are two US-based investment firms that have participated in at least 20 deals with Asian companies:\n\n1.  **Accel** (accel.com): Participated in **33 deals** (via entities including Accel India).\n2.  **Lightspeed Venture Partners** (lsvp.com): Participated in **22 deals**.",
      "expected_answer": "Accel has done 31 deals in that time frame and Lightspeed Venture Partners has done 22 deals",
      "sql_queries": [
        "-- Check address pattern for Asian companies\nSELECT DISTINCT address\nFROM organizations\nWHERE LOWER(address) LIKE '%india%' OR LOWER(address) LIKE '%china%' OR LOWER(address) LIKE '%japan%'\nLIMIT 10;\n",
        "-- US-based investors with >= 20 deals in Asian companies in 2025\nWITH asian_companies AS (\n    SELECT id\n    FROM organizations\n    WHERE is_investor = FALSE\n      AND address LIKE '%Asia'\n),\nus_investors AS (\n    SELECT id, name, domain\n    FROM organizations\n    WHERE is_investor = TRUE\n      AND country_code = 'United States'\n)\nSELECT \n    ui.domain,\n    MAX(ui.name) as investor_name,\n    COUNT(DISTINCT d.id) as asian_deal_count\nFROM us_investors ui\nJOIN institutional_investments ii ON ui.id = ii.organization_id\nJOIN deals d ON ii.deal_id = d.id\nJOIN asian_companies ac ON d.organization_id = ac.id\nWHERE d.date >= TIMESTAMP('2025-01-01')\n  AND d.date < TIMESTAMP('2026-01-01')\nGROUP BY ui.domain\nHAVING asian_deal_count >= 20\nORDER BY asian_deal_count DESC;\n"
      ],
      "expected_path": "Identify Asian country codes by looking at unique county codes, after getting that list. Then join institutional_investments to find deals, filter WHERE organization_id IN (subquery to organizations with discovered asian country codes) AND is_investor = TRUE and country_code = 'United States'. GROUP BY organization_id and name, COUNT deals. ORDER BY count DESC, LIMIT 20."
    },
    {
      "test_id": 7,
      "question": "Find founder teams where 3+ founders previously worked together at the same company at the same time (not including current company). Return all companies that were funded in 2025 that have this.",
      "grade": "pass",
      "reasoning": "The agent successfully identified the correct sets of founders and companies funded in 2025. Its logical approach was sophisticated; it used three SQL queries to refine the temporal overlap logic, eventually employing a pairwise overlap check (StartA < EndB AND StartB < EndA) and aggregating founders into groups of 3+ based on those overlaps. The results provided in the final answer (Catalogus, Runnr.ai, Pipeshift, Swish, Outfindo, TaleMonster/Swapp, 406 Energy, Peec AI, Factor2 Energy, and VyomIC) match the expected answer examples perfectly. While the agent did not include the 'startup_id' or the specific 'overlap period' dates in the final summary text (as requested by the 'Return' instruction), it demonstrated highly competent reasoning and identified the correct entities through a complex join and filtering process. The efficiency was also excellent, completing the task in 4 tool calls.",
      "tools_called_num": 4,
      "tools_called_expected": 4,
      "answer": "Based on the dataset, here are some founder teams whose companies were funded in 2025 and where at least three founders previously worked together at the same company at the same time:\n\n*   **Catalogus**: Founders **Himanshu Dikshit**, **Vipin Singh**, and **Ankit Samria** all previously worked together at **ANS Commerce**.\n*   **Runnr.ai**: The founding team consisting of **Michiel de Vor**, **Maarten Fugers**, and **Steven Oliemans** previously worked together at **Booking.com**.\n*   **Pipeshift**: Founders **Arko Chattopadhyay**, **Enrique Ferrao**, and **Pranav Reddy** share two previous employers where they worked together: **Amigo** and the **Hult Prize Foundation**.\n*   **Orange Quantum Systems**: This team has multiple overlapping backgrounds:\n    *   **Adriaan Rol**, **Garrelt Alberts**, and **Kelvin Loh** worked together at **QuTech**.\n    *   **Amber Hauwermeiren**, **Thorsten Last**, **Garrelt Alberts**, and **Kelvin Loh** worked together at **TNO**.\n*   **Swish**: Founders **Ujjwal Sukheja**, **Aniket Shah**, and **Saran S** previously worked together at **Pillow - DeFi For Everyone**.\n*   **Outfindo**: Founders **Jan Mateju**, **Martin Chrz**, and **Ondrej Bouda** were colleagues at **foodora**.\n*   **TaleMonster**: Founders **Emre Yanık**, **Simay Kahraman**, and **Berk Yaşar** worked together at **Peak Games**.\n*   **406 Energy**: Founders **Josh Sigler**, **Tom Kastens**, and **Mark Graeve** all previously worked at **XCL Resources**.\n*   **Peec AI**: Founders **Marius Meiners**, **Tobias Siwonia**, and **Daniel Drabo** worked together at **Antler**.\n*   **Factor2 Energy**: Founders **Felix Böhmer**, **Michael Wechsung**, and **Jörg Strohschein** were colleagues at **Siemens**.\n*   **VyomIC**: Founders **Anurag Patil**, **Vibhor Jain**, and **Lokesh Kabdal** worked together at **Avishkar Hyperloop**.",
      "expected_answer": "Results — for each company: (startup name — startup_id)\n- 406 Energy — e97b2ed2-6003-4717-b779-71a83868a4d3\n  • Prior employer: XCL Resources (linkedin id: xcl-resources)\n  • Founders who overlapped: Josh Sigler, Mark Graeve, Tom Kastens\n  • Overlap: 2018-09-01 → 2022-05-01\n\n- Catalogus — fb0a4be8-a8a1-45c9-a4e4-598b03472c4e\n  • Prior employer: ANS Commerce (anscommerce)\n  • Founders: Ankit Samria, Himanshu Dikshit, Vipin Singh\n  • Overlap: 2019-07-01 → 2019-09-01\n\n- Factor2 Energy — 79f58eb3-9f1b-4fbb-b673-cb4736e6ebe4\n  • Prior employer: Siemens (siemens)\n  • Founders: Felix Böhmer, Jörg Strohschein, Michael Wechsung\n  • Overlap examples: 2014-09-01 → 2016-06-01 and 2016-06-01 → 2017-09-01\n\n- Outfindo — 4d21dc9e-4033-414b-8288-cb05f1485d10\n  • Prior employer: foodora (foodora)\n  • Founders: Jan Mateju, Martin Chrz, Ondrej Bouda\n  • Overlap: 2016-05-01 → 2018-12-01\n\n- Peec AI — 43943b03-cbdc-489e-814b-807386ba8684\n  • Prior employer: Amazon (amazon)\n  • Founders: Gabriel Drabo, Marius Meiners, Tobias Siwonia\n  • Overlap: 2024-10-01 → 2024-12-01\n\n- Pipeshift — 91092a39-3395-4f30-a935-01288b80a016\n  • Prior employers: Amigo (youramigoapp) and Hult Prize Foundation (hult-prize-foundation)\n  • Founders: Arko Chattopadhyay, Enrique Ferrao, Pranav Reddy\n  • Overlaps: 2021-06-01 → 2022-12-01 (Amigo); 2022-06-01 → 2022-08-01 (Hult Prize)\n\n- Runnr.ai — 3cd51042-0d3f-40bf-b8cd-601cbf1e4abf\n  • Prior employer: Booking.com (booking.com)\n  • Founders: Maarten Fugers, Michiel de Vor, Steven Oliemans\n  • Multiple overlapping windows across 2011–2016 and 2013–2015\n\n- Swish — 4057c6f1-816e-492e-ad79-95041eb99550\n  • Prior employer: Pillow - DeFi For Everyone (pillowfund)\n  • Founders: Aniket Shah, Saran S, Ujjwal Sukheja\n  • Overlaps: 2022-01-01 → 2022-03-01\n\n- Swapp — ae6-7bfd-4b9f-8639-37e20c95fd66\n  • Prior employer: Peak Games (peak)\n  • Founders: Berk Yaşar, Emre Yanık, Simay Kahraman\n  • Overlaps: 2019-11-01 → 2022-01-01; 2022-01-01 → 2022-10-01\n\n- VyomIC — a623bd14-6574-4d21-86c6-5bce553c6c88\n  • Prior employer: Avishkar Hyperloop (avishkarhyperloop)\n  • Founders: Anurag Patil, Lokesh Kabdal, Vibhor Jain\n  • Overlap: 2021-08-01 → 2022-08-01",
      "sql_queries": [
        "WITH funded_2025 AS (\n    -- Companies funded in 2025\n    SELECT DISTINCT d.organization_id\n    FROM deals d\n    WHERE d.date >= TIMESTAMP('2025-01-01')\n      AND d.date < TIMESTAMP('2026-01-01')\n),\nfounders_2025 AS (\n    -- Founders of companies funded in 2025\n    SELECT \n        oa.organization_id,\n        o.name as current_company,\n        p.id as person_id,\n        p.name as founder_name\n    FROM organization_associations oa\n    JOIN organizations o ON oa.organization_id = o.id\n    JOIN people p ON oa.person_id = p.id\n    WHERE oa.organization_id IN (SELECT organization_id FROM funded_2025)\n      AND (oa.is_founder = TRUE OR LOWER(oa.title) LIKE '%founder%')\n      AND oa.is_investor = FALSE\n),\npast_positions AS (\n    -- Past positions of these founders\n    SELECT \n        f.organization_id as current_company_id,\n        f.current_company,\n        f.person_id,\n        f.founder_name,\n        lp.linkedin_company_id,\n        lc.company_name as past_company_name,\n        lp.start_date,\n        lp.end_date\n    FROM founders_2025 f\n    JOIN linkedin_positions lp ON f.person_id = lp.person_id\n    JOIN linkedin_company lc ON lp.linkedin_company_id = lc.id\n    WHERE lp.end_date IS NOT NULL -- Must be a past position\n),\noverlaps AS (\n    -- Find pairs of founders from same current company who worked at same past company together\n    SELECT \n        p1.current_company_id,\n        p1.current_company,\n        p1.linkedin_company_id,\n        p1.past_company_name,\n        p1.person_id as person1_id,\n        p1.founder_name as person1_name,\n        p2.person_id as person2_id,\n        p2.founder_name as person2_name\n    FROM past_positions p1\n    JOIN past_positions p2 ON p1.current_company_id = p2.current_company_id \n        AND p1.linkedin_company_id = p2.linkedin_company_id\n        AND p1.person_id < p2.person_id -- Avoid duplicate pairs and self-join\n    WHERE \n        -- Overlap logic: (StartA < EndB) AND (StartB < EndA)\n        p1.start_date < p2.end_date \n        AND p2.start_date < p1.end_date\n),\ntriple_overlaps AS (\n    -- Find past companies where 3+ founders worked together\n    -- To be precise: they must all share an overlap. For simplicity, we count distinct people \n    -- who had an overlap with at least one other founder at that company.\n    -- Better: Group by current company and past company, count distinct founders.\n    SELECT \n        current_company_id,\n        current_company,\n        past_company_name,\n        COUNT(DISTINCT person1_id) + 1 as overlapping_founders_count -- Simple approximation\n    FROM overlaps\n    GROUP BY current_company_id, current_company, past_company_name\n)\n-- Refined check: Count how many distinct founders from the same company were at the same past company\nSELECT \n    f.current_company,\n    lp.past_company_name,\n    COUNT(DISTINCT f.person_id) as founder_count,\n    ARRAY_AGG(DISTINCT f.founder_name) as founder_names\nFROM founders_2025 f\nJOIN past_positions lp ON f.person_id = lp.person_id\nGROUP BY f.organization_id, f.current_company, lp.linkedin_company_id, lp.past_company_name\nHAVING founder_count >= 3\nORDER BY founder_count DESC;\n",
        "WITH f2025 AS (\n    -- Companies with a deal in 2025\n    SELECT DISTINCT o.id, o.name\n    FROM organizations o\n    JOIN deals d ON o.id = d.organization_id\n    WHERE d.date >= TIMESTAMP('2025-01-01') AND d.date < TIMESTAMP('2026-01-01')\n),\nfounder_history AS (\n    -- Past positions of founders of these companies\n    SELECT \n        f.id as current_id,\n        f.name as current_name,\n        p.id as person_id,\n        p.name as person_name,\n        lp.linkedin_company_id,\n        lc.company_name as past_name,\n        lp.start_date,\n        lp.end_date\n    FROM f2025 f\n    JOIN organization_associations oa ON f.id = oa.organization_id\n    JOIN people p ON oa.person_id = p.id\n    JOIN linkedin_positions lp ON p.id = lp.person_id\n    JOIN linkedin_company lc ON lp.linkedin_company_id = lc.id\n    WHERE (oa.is_founder = TRUE OR LOWER(oa.title) LIKE '%founder%')\n      AND oa.is_investor = FALSE\n      AND lp.end_date IS NOT NULL\n),\noverlapping_pairs AS (\n    -- Pairs of founders from same company who worked at same past company at same time\n    SELECT \n        h1.current_id,\n        h1.current_name,\n        h1.linkedin_company_id,\n        h1.past_name,\n        h1.person_id as p1_id,\n        h1.person_name as p1_name,\n        h2.person_id as p2_id,\n        h2.person_name as p2_name\n    FROM founder_history h1\n    JOIN founder_history h2 ON h1.current_id = h2.current_id \n        AND h1.linkedin_company_id = h2.linkedin_company_id\n        AND h1.person_id < h2.person_id\n    WHERE h1.start_date < h2.end_date \n      AND h2.start_date < h1.end_date\n),\ncandidate_groups AS (\n    -- Identify groups where 3+ founders were involved in overlapping pairs\n    SELECT \n        current_id,\n        current_name,\n        linkedin_company_id,\n        past_name,\n        COUNT(DISTINCT p1_id) + 1 as roughly_count -- This is an upper bound\n    FROM overlapping_pairs\n    GROUP BY current_id, current_name, linkedin_company_id, past_name\n    HAVING roughly_count >= 3\n)\n-- Final check: For each candidate group, select the founders and verify there's an intersection\n-- Actually, Helly's theorem says if all pairs overlap, the whole set overlaps.\n-- So we need to ensure that for a group of 3 {A,B,C}, (A,B), (A,C), and (B,C) are all in overlapping_pairs.\nSELECT \n    cg.current_name as company,\n    cg.past_name as previous_employer,\n    ARRAY_AGG(DISTINCT p.person_name) as overlapping_founders\nFROM candidate_groups cg\nJOIN (\n    SELECT current_id, linkedin_company_id, p1_id as pid, p1_name as person_name FROM overlapping_pairs\n    UNION DISTINCT\n    SELECT current_id, linkedin_company_id, p2_id as pid, p2_name as person_name FROM overlapping_pairs\n) p ON cg.current_id = p.current_id AND cg.linkedin_company_id = p.linkedin_company_id\nGROUP BY cg.current_name, cg.past_name\nHAVING ARRAY_LENGTH(overlapping_founders) >= 3;\n",
        "WITH f2025 AS (\n    SELECT DISTINCT o.id, o.name\n    FROM organizations o\n    JOIN deals d ON o.id = d.organization_id\n    WHERE d.date >= TIMESTAMP('2025-01-01') AND d.date < TIMESTAMP('2026-01-01')\n),\nfounder_history AS (\n    SELECT \n        f.id as cid, f.name as cname, p.id as pid, p.name as pname,\n        lp.linkedin_company_id as lcid, lc.company_name as p_name,\n        lp.start_date as s, lp.end_date as e\n    FROM f2025 f\n    JOIN organization_associations oa ON f.id = oa.organization_id\n    JOIN people p ON oa.person_id = p.id\n    JOIN linkedin_positions lp ON p.id = lp.person_id\n    JOIN linkedin_company lc ON lp.linkedin_company_id = lc.id\n    WHERE (oa.is_founder = TRUE OR LOWER(oa.title) LIKE '%founder%')\n      AND oa.is_investor = FALSE\n      AND lp.end_date IS NOT NULL\n),\noverlapping_pairs AS (\n    SELECT \n        h1.cid, h1.cname, h1.lcid, h1.p_name,\n        h1.pid as p1, h1.pname as n1,\n        h2.pid as p2, h2.pname as n2\n    FROM founder_history h1\n    JOIN founder_history h2 ON h1.cid = h2.cid \n        AND h1.lcid = h2.lcid\n        AND h1.pid < h2.pid\n    WHERE h1.s < h2.e AND h2.s < h1.e\n),\ncandidate_groups AS (\n    SELECT cid, cname, lcid, p_name, COUNT(DISTINCT p1) + 1 as cnt\n    FROM overlapping_pairs\n    GROUP BY cid, cname, lcid, p_name\n    HAVING cnt >= 3\n)\nSELECT \n    cg.cname as company,\n    cg.p_name as previous_employer,\n    ARRAY_AGG(DISTINCT p.person_name) as overlapping_founders\nFROM candidate_groups cg\nJOIN (\n    SELECT cid, lcid, p1 as pid, n1 as person_name FROM overlapping_pairs\n    UNION DISTINCT\n    SELECT cid, lcid, p2 as pid, n2 as person_name FROM overlapping_pairs\n) p ON cg.cid = p.cid AND cg.lcid = p.lcid\nGROUP BY cg.cname, cg.p_name\nHAVING ARRAY_LENGTH(overlapping_founders) >= 3\n"
      ],
      "expected_path": "Filter deals WHERE EXTRACT(YEAR FROM date) = 2025 to get funded companies. Join to organization_associations WHERE is_founder = TRUE to get founders. Join to linkedin_positions for each founder to get work history. Self-join linkedin_positions three ways (p1, p2, p3) WHERE p1.linkedin_company_id = p2.linkedin_company_id = p3.linkedin_company_id AND p1.person_id < p2.person_id < p3.person_id (avoids duplicate triples). Calculate overlap window: GREATEST(p1.start_date, p2.start_date, p3.start_date) <= LEAST(p1.end_date, p2.end_date, p3.end_date). Join to organizations and linkedin_company for names. Return startup name, startup_id, prior employer, founders who overlapped, overlap period."
    },
    {
      "test_id": 8,
      "question": "Find company with most secondary market transactions and show which investors bought secondary shares",
      "grade": "fail",
      "reasoning": "The agent failed to perform any actions, execute any SQL queries, or provide a meaningful answer. The response '<ctrl46><ctrl46>' is likely a technical glitch or an empty output, and does not address the question at all.",
      "tools_called_num": 0,
      "tools_called_expected": 2,
      "answer": "<ctrl46><ctrl46>",
      "expected_answer": "OpenAI (openai.com) has 3 secondary deals -  Top investors who bought secondary shares (deal counts): Thrive Capital (3), Founders Fund (1), K2 Global (1), Andreessen Horowitz (1), Dragoneer Investment Group (1), MGX (1), T. Rowe Price Associates (1), Sequoia Capital (1), SoftBank (1)",
      "sql_queries": [],
      "expected_path": "Filter deals WHERE financing_type = 'SECONDARY_MARKET', COUNT(DISTINCT deals.id) grouped by organization_id. REMINDER: SECONDARY_MARKET represents existing shares traded (not new capital raised) but IS included in deal counts. Join to organizations to get company names. For top companies, join deals → institutional_investments → organizations (investor) to get investor names. CRITICAL: Multiple investors per deal creates 1:N - use STRING_AGG or ARRAY_AGG to concatenate investor names without cartesian products. ORDER BY secondary_transaction_count DESC. Return company name, number of secondary transactions, aggregated list of investors, transaction dates."
    },
    {
      "test_id": 9,
      "question": "Which investor has the highest led deal percentage in 2024 while taking part in at least 10 deals in 2024r",
      "grade": "pass",
      "reasoning": "The agent followed a logical and efficient approach to solve the query. It correctly identified the necessary tables (institutional_investments, deals, and organizations), applied the date filter for 2024, calculated the total deals and led deals per investor, and filtered for the minimum threshold of 10 deals. The resulting SQL query is sound, and the final answer (Unicorn India Ventures, 100% led rate) matches one of the top results provided in the expected answer example. The agent used only one tool call, demonstrating high efficiency.",
      "tools_called_num": 1,
      "tools_called_expected": 3,
      "answer": "The investor with the highest led deal percentage in 2024 (among those with at least 10 deals) is **Unicorn India Ventures**. They participated in **10 deals** in 2024 and led **all 10** of them, resulting in a **100% led deal percentage**.",
      "expected_answer": "- CIBC Innovation Banking — 34 deals participated, 34 led (lead rate = 100%), Leonid Capital Partners — 12 deals participated, 12 led (100%) , Decathlon Capital Partners — 10 deals participated, 10 led (100%)  ,PeakSpan Capital — 10 deals participated, 10 led (100%)  ,Unicorn India Ventures — 10 deals participated, 10 led (100%)",
      "sql_queries": [
        "WITH investor_deals AS (\n    SELECT \n        o.domain,\n        MAX(o.name) as investor_name,\n        COUNT(DISTINCT ii.deal_id) as total_deals,\n        COUNT(DISTINCT CASE WHEN ii.lead_investor = TRUE THEN ii.deal_id END) as led_deals\n    FROM institutional_investments ii\n    JOIN deals d ON ii.deal_id = d.id\n    JOIN organizations o ON ii.organization_id = o.id\n    WHERE d.date >= TIMESTAMP('2024-01-01') \n      AND d.date < TIMESTAMP('2025-01-01')\n      AND o.is_investor = TRUE\n    GROUP BY o.domain\n    HAVING total_deals >= 10\n)\nSELECT \n    investor_name,\n    domain,\n    total_deals,\n    led_deals,\n    ROUND((CAST(led_deals AS FLOAT64) / total_deals) * 100, 2) as led_percentage\nFROM investor_deals\nORDER BY led_percentage DESC\nLIMIT 1;\n"
      ],
      "expected_path": "Filter deals WHERE EXTRACT(YEAR FROM date) = 2024. Join institutional_investments → organizations (investor). GROUP BY investor organization_id and name. Calculate: COUNT(DISTINCT CASE WHEN ii.lead_investor = TRUE THEN deals.id END) / COUNT(DISTINCT deals.id) * 100 AS lead_percentage. Filter HAVING COUNT(DISTINCT deals.id) >= 10 (minimum activity threshold). CRITICAL: lead_investor flag distinguishes lead vs participant roles. REMINDER: Deal counts INCLUDE SECONDARY_MARKET. ORDER BY lead_percentage DESC LIMIT 1. Return investor name, total deals in 2024, led deals count, led percentage."
    }
  ]
}