{
  "metadata": {
    "total_tests": 9,
    "passed": 9,
    "failed": 0,
    "pass_rate": 100,
    "timestamp": "2026-01-07T20:46:20.498Z",
    "duration_ms": 611138,
    "duration": "10m 11s",
    "total_tool_calls": 22,
    "total_expected_tool_calls": 36
  },
  "tests": [
    {
      "test_id": 1,
      "question": "what are some seed stage companies whos founder went to mit sloan and y combinator invested in them",
      "grade": "pass",
      "reasoning": "The agent followed a sensible, defensible approach and produced a correct, concise result. Their SQL logic matches the expected strategy: identify Y Combinator as an investor, identify MIT Sloan education records, join deals to companies and institutional_investments to verify YC participation, and join founders to their LinkedIn education to confirm the MIT Sloan connection. The agent returned a concrete matching seed-stage company (Deasie) with founder, LinkedIn link, seed date/amount, and investor list — which aligns with the example and requirements. Efficiency is good: the task was completed in 3 tool calls (well within the expected guideline) and queries were not redundant. One minor note: the agent hardcoded two MIT Sloan IDs in the final query rather than dynamically pulling them from linkedin_education, but this is a reasonable, scalable assumption in this context and did not undermine correctness. Overall the approach, execution, and output are competent and defensible.",
      "tools_called_num": 3,
      "tools_called_expected": 6,
      "answer": "I found 1 matching seed-stage company.\n\n- Deasie — seed on 2023-10-12 (seed amount: $2.9M)\n  - Founder: Mikko Peiponen — https://www.linkedin.com/in/mikkopeiponen/\n  - Investors (in that seed): Y Combinator; Rebel Fund\n  - Website/domain: deasie.com\n\nIf you want, I can expand the search (include MIT Sloan executive programs only vs full program, broaden investor matches to any YC-affiliated entity, or return more fields).",
      "expected_answer": "Deasie founder Mikko Peiponen went to MIT Sloan School of Management and Y Combinator invested in them",
      "sql_queries": [
        "SELECT id, name, domain, is_investor\nFROM organizations\nWHERE (SEARCH(organizations, 'y combinator') OR SEARCH(organizations, 'yc'))\n  AND is_investor = TRUE\nLIMIT 100;",
        "SELECT id, education_name, education_url\nFROM linkedin_education\nWHERE SEARCH(linkedin_education, 'sloan') OR SEARCH(linkedin_education, 'mit sloan')\nLIMIT 50;",
        "WITH yc_investors AS (\n  SELECT id, name, domain\n  FROM organizations\n  WHERE (SEARCH(organizations, 'y combinator') OR domain = 'ycombinator.com' OR SEARCH(organizations, 'yc'))\n    AND is_investor = TRUE\n),\nmit_ids as (\n  SELECT 'mit-sloan-school-of-management' AS id UNION ALL\n  SELECT 'mit-sloan-executive-education' AS id\n)\n\nSELECT\n  o.id AS company_id,\n  o.name AS company_name,\n  o.domain,\n  FORMAT_TIMESTAMP('%Y-%m-%d', d.date) AS seed_date,\n  d.size_usd AS seed_amount_usd_millions,\n  STRING_AGG(DISTINCT p.name, ', ' ORDER BY p.name) AS founder_names,\n  ARRAY_AGG(DISTINCT p.linkedin_person_url) AS founder_links,\n  ARRAY_AGG(DISTINCT yi.name) AS yc_entities\nFROM deals d\nJOIN organizations o ON o.id = d.organization_id AND o.is_investor = FALSE\nJOIN institutional_investments ii ON ii.deal_id = d.id\nJOIN organizations yi ON yi.id = ii.organization_id AND yi.is_investor = TRUE\nJOIN organization_associations oa ON oa.organization_id = o.id AND oa.is_founder = TRUE\nJOIN people p ON p.id = oa.person_id\nJOIN linkedin_person_education lpe ON lpe.person_id = p.id\nWHERE d.financing_type = 'SEED'\n  AND lpe.linkedin_education_id IN (SELECT id FROM mit_ids)\n  AND yi.id IN (SELECT id FROM yc_investors)\nGROUP BY o.id, o.name, o.domain, d.date, d.size_usd\nORDER BY d.date DESC\nLIMIT 200;"
      ],
      "expected_path": "Discover MIT in linkedin_education, join to linkedin_person_education to find alumni, discover Y Combinator (is_investor=TRUE), join institutional_investments to find YC portfolio companies, join organization_associations WHERE is_current=TRUE to find current employees at those companies, COUNT distinct people."
    },
    {
      "test_id": 2,
      "question": "what is openais valuation since start of 2025: for each fundraise what was their valuation",
      "grade": "pass",
      "reasoning": "The agent followed a reasonable, defensible approach: discover OpenAI in the organizations table, retrieve its valuations and deals, and match valuations to fundraises (they used a 180-day nearest-valuation match and noted when a valuation was from a nearby date). The reported results (Mar 31 2025 $40B at $300B; Aug 1 2025 $8.3B at $300B; Oct 2 2025 $6.6B secondary at $500B; Dec 11 2025 $1B with nearest valuation $500B from Oct 2) are internally consistent with the queries shown and match the expected example structure. Efficiency is acceptable: the agent used 5 tool calls (one more than the suggested ≤4), but the extra query appears to be minor redundancy (two initial searches) and the final combined query to join deals→valuations was appropriate. No fundamental logic errors, missing core requirements, or incorrect joins were evident. Overall the answer is defensible, correctly qualified (they flagged the nearest-valuation match and valuation_type unknown), and complete for the question asked.",
      "tools_called_num": 5,
      "tools_called_expected": 4,
      "answer": "Here are OpenAI's fundraises since 2025 and the valuation associated with each round (dataset values are stored in millions USD):\n\n- 2025-03-31 — EQUITY — raised $40,000M ($40.0B); valuation on 2025-03-31: $300,000M ($300.0B).\n- 2025-08-01 — EQUITY — raised $8,300M ($8.3B); valuation on 2025-08-01: $300,000M ($300.0B).\n- 2025-10-02 — SECONDARY_MARKET — raised $6,600M ($6.6B); valuation on 2025-10-02: $500,000M ($500.0B).\n- 2025-12-11 — EQUITY — raised $1,000M ($1.0B); nearest valuation within 180 days: $500,000M ($500.0B) (valuation date: 2025-10-02; valuation_type not specified).\n\nIf you want, I can:\n- show pre-/post-money valuation_type where available,\n- return the source article links for each deal, or\n- expand the window used to match valuations to fundraises.",
      "expected_answer": "In march 2025: raises $40B at $300B valuation, in August raised $8.3B at $300B, in Oct had secondary selling $6.6B at $500B. Most recent $1B raise in Dec 2025 didnt' have valuation attached. ",
      "sql_queries": [
        "SELECT id, name, domain, latest_valuation_usd, latest_valuation_date\nFROM organizations\nWHERE SEARCH(organizations, 'openai')\n  AND is_investor = FALSE\nLIMIT 50;",
        "SELECT id, name, domain, is_investor, latest_valuation_usd, latest_valuation_date\nFROM organizations\nWHERE SEARCH(organizations, 'openai')\nLIMIT 50;",
        "SELECT v.id, v.organization_id, o.name, o.domain, v.valuation_usd, v.valuation_type, FORMAT_TIMESTAMP('%Y-%m-%d', v.date) AS valuation_date\nFROM valuations v\nJOIN organizations o ON o.id = v.organization_id\nWHERE SEARCH(o, 'openai')\nORDER BY v.date DESC\nLIMIT 50;",
        "SELECT id, name, domain, is_investor, latest_valuation_usd, latest_valuation_date\nFROM organizations\nWHERE id = '97ae048e-77bc-471b-821a-f9decb373689'\nLIMIT 10;",
        "WITH target_org AS (\n  SELECT id, name\n  FROM organizations\n  WHERE id = '97ae048e-77bc-471b-821a-f9decb373689'\n),\nopenai_deals AS (\n  SELECT d.*\n  FROM deals d\n  JOIN target_org o ON o.id = d.organization_id\n  WHERE d.date >= TIMESTAMP('2025-01-01')\n  ORDER BY d.date\n)\n\nSELECT\n  d.id AS deal_id,\n  FORMAT_TIMESTAMP('%Y-%m-%d', d.date) AS deal_date,\n  d.financing_type,\n  d.size_usd AS deal_size_usd_millions,\n  v.valuation_usd AS valuation_usd_millions,\n  v.valuation_type,\n  FORMAT_TIMESTAMP('%Y-%m-%d', v.date) AS valuation_date,\n  ABS(TIMESTAMP_DIFF(v.date, d.date, DAY)) AS days_between\nFROM openai_deals d\nLEFT JOIN valuations v ON v.organization_id = d.organization_id\n  AND ABS(TIMESTAMP_DIFF(v.date, d.date, DAY)) <= 180\n\nQUALIFY ROW_NUMBER() OVER (PARTITION BY d.id ORDER BY ABS(TIMESTAMP_DIFF(v.date, d.date, DAY)) ASC NULLS LAST) = 1\nORDER BY d.date;\n"
      ],
      "expected_path": "Discover OpenAI in organizations (domain = 'openai.com'), join to valuations to get valuation history"
    },
    {
      "test_id": 3,
      "question": "i want to talk to people on the sales leadership team at pave the comp platform. Who are some people i can speak to and their contact info (email, phone, linkedin)",
      "grade": "pass",
      "reasoning": "The agent followed a reasonable, defensible approach: it discovered the organization, used organization_associations joined to people, filtered for current employees and sales/customer-facing titles, and returned names with the contact fields available in the dataset. The SQL shown matches the expected strategy and the second query includes appropriate title filters; the third query (full current roster ordered by title) is a sensible verification step to avoid missing people. Tool usage (3 calls) is efficient and within the acceptable range.\n\nAnswer quality: The agent returned plausible contacts (VP/Director-level and customer-facing roles) and transparently indicated when emails/phones were not available in the dataset. There are minor concerns to note but not fatal: one returned email (afarrokh@30mpc.com) looks like a different domain than the company (this likely reflects the source dataset and the agent appropriately reported it rather than fabricating data), and an Account Executive was included even though the user asked for \"sales leadership\" — but the agent labeled the group as \"sales/customer-facing leadership\" and offered to expand or search public sources for missing contact info. These are acceptable, defensible choices given the ambiguity of \"sales leadership\" and data availability.\n\nOverall, the agent completed the task, used a logical method, was efficient, and was transparent about missing data and next steps. Therefore the submission should pass.",
      "tools_called_num": 3,
      "tools_called_expected": 5,
      "answer": "Here are people on Pave’s sales/customer-facing leadership (from the dataset) with the contact details available:\n\n- Armand Farrokh — VP of Sales  \n  - Email: afarrokh@30mpc.com  \n  - Phone: +1 310-962-5822  \n  - LinkedIn: https://www.linkedin.com/in/armand-farrokh/\n\n- Harry Lort-Phillips — Director, Sales  \n  - Email: harry@pave.com  \n  - Phone: (not available in dataset)  \n  - LinkedIn: https://www.linkedin.com/in/harry-lort-phillips/\n\n- Philip Farr — Head of Customer Success  \n  - Email: (not available in dataset)  \n  - Phone: (not available in dataset)  \n  - LinkedIn: https://www.linkedin.com/in/philip-farr/\n\n- LaRon Bullock — Account Executive  \n  - Email: (not available in dataset)  \n  - Phone: (not available in dataset)  \n  - LinkedIn: https://www.linkedin.com/in/laron-bullock/\n\nIf you’d like, I can:\n- try to expand to additional customer-facing contacts (SDRs, AEs, CSMs),  \n- return company-provided press or team pages, or  \n- search public sources for missing emails/phone numbers and add them.",
      "expected_answer": "You can talk to VP of Sales Armand Farrokh (https://www.linkedin.com/in/armand-farrokh/) email: afarrokh@30mpc.com  or Harry Lort-Phillips (https://www.linkedin.com/in/harry-lort-phillips/) email: harry@pave.com",
      "sql_queries": [
        "SELECT id, name, domain, short_description\nFROM organizations\nWHERE (SEARCH(organizations, 'pave') OR SEARCH(organizations, 'pave the comp platform') OR domain = 'pave.com')\n  AND is_investor = FALSE\nLIMIT 50;",
        "SELECT p.id AS person_id, p.name AS person_name, oa.title, p.email, p.phone, p.linkedin_person_url\nFROM organization_associations oa\nJOIN people p ON p.id = oa.person_id\nWHERE oa.organization_id = 'bb1b34cf-9d07-47f2-87a4-f5248945264d'\n  AND oa.is_current = TRUE\n  AND (\n    LOWER(oa.title) LIKE '%sales%'\n    OR LOWER(oa.title) LIKE '%revenue%'\n    OR LOWER(oa.title) LIKE '%account%'\n    OR LOWER(oa.title) LIKE '%business development%'\n    OR LOWER(oa.title) LIKE '%bd%'\n    OR LOWER(oa.title) LIKE '%head of%'\n    OR LOWER(oa.title) LIKE '%vp %'\n    OR LOWER(oa.title) LIKE '%director%'\n    OR LOWER(oa.title) LIKE '%chief revenue%'\n  )\nLIMIT 100;",
        "SELECT p.id AS person_id, p.name AS person_name, oa.title, p.email, p.phone, p.linkedin_person_url\nFROM organization_associations oa\nJOIN people p ON p.id = oa.person_id\nWHERE oa.organization_id = 'bb1b34cf-9d07-47f2-87a4-f5248945264d'\n  AND oa.is_current = TRUE\nORDER BY oa.title\nLIMIT 200;"
      ],
      "expected_path": "Discover Pave in organizations (domain = 'pave.com'), join to organization_associations to find people, filter WHERE is_current=TRUE and look for sales related roles, return people's names, emails, and linkedin profiles."
    },
    {
      "test_id": 4,
      "question": "Find companies that raised Series B within 6 months of Series A that are US based and have raised at least $150M (both rounds in 2025)",
      "grade": "pass",
      "reasoning": "The agent followed a logical, defensible approach and produced a plausible answer with efficient execution. Positives: they used a self-join on the deals table (a and b) and joined to organizations to return company names; they filtered for SERIES_A and SERIES_B in 2025 and ensured the B came after A; they enforced the 6-month proximity (used TIMESTAMP_DIFF in days) and the funding minimum by summing the two rounds; and they completed everything in a single query (efficient). Minor issues/notes (not fatal):\n- The agent used a 180-day cutoff (TIMESTAMP_DIFF(..., DAY) <= 180) rather than a month-based TIMESTAMP(DATE_SUB(..., INTERVAL 6 MONTH)) check suggested in the prompt. This is a reasonable, equivalent approximation for \"within 6 months,\" though it can differ by a few days for some date ranges. This does not invalidate the approach. \n- The US filter is implemented with a mix of country_code/address/region heuristics; it's pragmatic but could miss or misclassify some orgs depending on data cleanliness. \n- They summed A+B to enforce \"at least $150M,\" which is a reasonable interpretation of the ambiguous requirement (could also be read as each round >= $150M). The agent’s interpretation is defensible and consistent with the returned results.\n- Minor SQL redundancies (ABS(...) while also requiring b.date >= a.date, GROUP BY with no aggregates) are inefficiencies but not substantive errors.\nOverall, the agent met the task requirements, used a sound SQL strategy, and executed efficiently (1 tool call). Therefore the result deserves a pass.",
      "tools_called_num": 1,
      "tools_called_expected": 4,
      "answer": "Here are the US-based companies that raised a Series A and a Series B in 2025 within 6 months of each other and whose combined A+B (both in 2025) was at least $150M:\n\n1. Apptronik — apptronik.com  \n   - Series A: 2025-02-13 — $350M  \n   - Series B: 2025-03-18 — $53M  \n   - Combined (A+B): $403M  \n   - Days between rounds: 33\n\n2. OpenEvidence — openevidence.com  \n   - Series A: 2025-02-24 — $75M  \n   - Series B: 2025-07-15 — $210M  \n   - Combined (A+B): $285M  \n   - Days between rounds: 141\n\n3. Chai Discovery — chaidiscovery.com  \n   - Series A: 2025-08-06 — $70M  \n   - Series B: 2025-12-15 — $130M  \n   - Combined (A+B): $200M  \n   - Days between rounds: 130\n\nIf you want, I can return the full deal records (deal IDs, article links), or export this as a CSV.",
      "expected_answer": "OpenEvidence — openevidence.com — $735.0M — 2025-02-24 → 2025-07-15 — 5 months (141 days) , Apptronik — apptronik.com — $417.6M — 2025-02-13 → 2025-03-18 — 1 month (33 days), Chai Discovery — chaidiscovery.com — $200.0M — 2025-08-06 → 2025-12-15 — 4 months (130 days), and Adaptive Security — adaptivesecurity.com — $179.0M — 2025-09-18 → 2025-12-16 — 3 months (88 days)",
      "sql_queries": [
        "SELECT\n  o.id AS company_id,\n  o.name AS company_name,\n  o.domain,\n  FORMAT_TIMESTAMP('%Y-%m-%d', a.date) AS series_a_date,\n  a.size_usd AS series_a_size_millions,\n  FORMAT_TIMESTAMP('%Y-%m-%d', b.date) AS series_b_date,\n  b.size_usd AS series_b_size_millions,\n  (COALESCE(a.size_usd,0) + COALESCE(b.size_usd,0)) AS combined_size_millions,\n  ABS(TIMESTAMP_DIFF(b.date, a.date, DAY)) AS days_between\nFROM deals a\nJOIN deals b ON a.organization_id = b.organization_id\nJOIN organizations o ON o.id = a.organization_id AND o.is_investor = FALSE\nWHERE a.financing_type = 'SERIES_A'\n  AND b.financing_type = 'SERIES_B'\n  AND EXTRACT(YEAR FROM a.date) = 2025\n  AND EXTRACT(YEAR FROM b.date) = 2025\n  AND b.date >= a.date\n  AND ABS(TIMESTAMP_DIFF(b.date, a.date, DAY)) <= 180\n  AND (COALESCE(a.size_usd,0) + COALESCE(b.size_usd,0)) >= 150\n  AND (\n    o.country_code = 'United States'\n    OR LOWER(o.address) LIKE '%united states%'\n    OR o.region = 'California'\n    OR o.region = 'New York'\n  )\nGROUP BY o.id, o.name, o.domain, a.date, a.size_usd, b.date, b.size_usd\nORDER BY combined_size_millions DESC\nLIMIT 200;"
      ],
      "expected_path": "Self-join deals table (d1 and d2) on organization_id, filter d1 WHERE financing_type = 'SERIES_A' and d2 WHERE financing_type = 'SERIES_B', calculate time difference between d2.date and d1.date. CRITICAL: deals.date is TIMESTAMP type - use TIMESTAMP(DATE_SUB(d2.date, INTERVAL 6 MONTH)) <= d1.date for month-based comparisons. Join to organizations to get company names. Return company name, Series A date, Series B date, time difference."
    },
    {
      "test_id": 5,
      "question": "For US-based fintech companies what is an average valuation at series A stage in 2025 - provide some examples",
      "grade": "pass",
      "reasoning": "The agent followed a logical, defensible approach and produced a transparent, reproducible result. Strengths: (1) They discovered an appropriate fintech industry permalink via SEARCH and then filtered organizations by organization_industries + is_investor = FALSE and US location — a correct way to identify US fintech firms. (2) They limited deals to SERIES_A in 2025 and used a nearest-valuation match (ABS(TIMESTAMP_DIFF) <= 180 days + ROW_NUMBER() QUALIFY) to choose the most relevant valuation record — this matches the stated matching-rule intent. (3) They reported aggregated output (average = $250.0M) and explicitly stated the sample size (1) and data limitations, and provided example companies and next-step options (expand window / broaden industry). (4) Tool usage was efficient (3 calls), reasonable and not redundant. Minor notes (not fatal): (a) they used a JOIN with DISTINCT instead of an explicit subquery pattern to avoid 1:N duplication — functionally acceptable here and not a correctness problem; (b) the average is based on a single matched valuation, meaning the numeric average is not robust — the agent properly flagged this limitation. Given the sound methodology, correct filtering for Series A in 2025, transparent handling of valuation matching, reasonable tool call count, and clear caveats, the agent successfully completed the task. If another model produced the exact same queries/results, it should receive the same grade.",
      "tools_called_num": 3,
      "tools_called_expected": 4,
      "answer": "Short answer — average Series A valuation for US-based fintech companies in 2025 (per the dataset): $250.0M.  \n\nImportant note: that average is based on 1 Series A with a recorded valuation within ±180 days of the round (sample size = 1). Many 2025 Series A fintech deals in the data do not have an associated valuation record within that window, so the dataset has limited valuation coverage for this cohort.\n\nExample companies (US fintechs with Series A in 2025 from the dataset):\n\n- Ostium (ostium.io)  \n  - Series A: 2025-12-04 — $24.0M  \n  - Series A valuation (nearest within 180 days): $250.0M (valuation date: 2025-12-03)\n\nOther fintech Series A deals in 2025 (valuation not available in dataset within ±180 days):\n- Campfire (meetcampfire.com) — Series A: 2025-06-30 — $35.0M  \n- Spinwheel (spinwheel.io) — Series A: 2025-06-23 — $30.0M  \n- Cascading AI (cascading.ai) — Series A: 2025-08-19 — $29.0M  \n- Rillet (rillet.com) — Series A: 2025-05-28 — $25.0M  \n- SureCo (sureco.com) — Series A: 2025-09-30 — $23.0M\n\nIf you want more robust results I can:\n- expand the valuation-match window (e.g., ±1 year) to capture more valuations, or  \n- broaden the industry definition (include related financial-services permalinks or text-based fintech matches) and re-run so we have a larger sample for the average.",
      "expected_answer": "Average Series A valuation for US-based fintech companies in 2025 (per Fundable data & our matching rules): $1,797 million (≈ $1.8B). This average is computed from 3 Series A deals in 2025 for US fintech companies where we could match a recorded valuation. Examples: Tempo — deal date 2025-10-17, Series A size: $500.0M, Matched valuation: $5,000.0M, Website: https://tempo.xyz/; Ostium — deal date 2025-12-04, Series A size: $24.0M, Matched valuation: $250.0M, Website: https://www.ostium.io; Strive Asset Management — deal date 2025-11-10, Series A size: $160.0M, Matched valuation: $141.0M, Website: https://www.strivefunds.com",
      "sql_queries": [
        "SELECT DISTINCT industry_name, industry_permalink, super_category_name, super_category_permalink\nFROM industry_classifications\nWHERE SEARCH(industry_classifications, 'fintech')\nLIMIT 50;",
        "WITH fintech_orgs AS (\n  SELECT DISTINCT o.id, o.name, o.domain\n  FROM organizations o\n  JOIN organization_industries oi ON oi.organization_id = o.id\n  WHERE oi.industry_permalink = 'fintech-e067'\n    AND o.is_investor = FALSE\n    AND (o.country_code = 'United States' OR LOWER(o.address) LIKE '%united states%')\n),\nseries_a_deals AS (\n  SELECT d.*\n  FROM deals d\n  JOIN fintech_orgs fo ON fo.id = d.organization_id\n  WHERE d.financing_type = 'SERIES_A'\n    AND EXTRACT(YEAR FROM d.date) = 2025\n),\nvaluations_near_a AS (\n  SELECT\n    d.id AS deal_id,\n    d.organization_id,\n    d.date AS deal_date,\n    d.size_usd AS series_a_size_millions,\n    v.valuation_usd,\n    v.valuation_type,\n    v.date AS valuation_date,\n    ABS(TIMESTAMP_DIFF(v.date, d.date, DAY)) AS days_between\n  FROM series_a_deals d\n  LEFT JOIN valuations v ON v.organization_id = d.organization_id\n    AND ABS(TIMESTAMP_DIFF(v.date, d.date, DAY)) <= 180\n  QUALIFY ROW_NUMBER() OVER (PARTITION BY d.id ORDER BY ABS(TIMESTAMP_DIFF(v.date, d.date, DAY)) ASC NULLS LAST) = 1\n)\n\nSELECT\n  COUNT(*) AS sample_count,\n  ROUND(AVG(valuation_usd), 2) AS avg_series_a_valuation_usd_millions\nFROM valuations_near_a\nWHERE valuation_usd IS NOT NULL;",
        "WITH fintech_orgs AS (\n  SELECT DISTINCT o.id, o.name, o.domain\n  FROM organizations o\n  JOIN organization_industries oi ON oi.organization_id = o.id\n  WHERE oi.industry_permalink = 'fintech-e067'\n    AND o.is_investor = FALSE\n    AND (o.country_code = 'United States' OR LOWER(o.address) LIKE '%united states%')\n),\nseries_a_deals AS (\n  SELECT d.*\n  FROM deals d\n  JOIN fintech_orgs fo ON fo.id = d.organization_id\n  WHERE d.financing_type = 'SERIES_A'\n    AND EXTRACT(YEAR FROM d.date) = 2025\n),\nvaluations_near_a AS (\n  SELECT\n    d.id AS deal_id,\n    d.organization_id,\n    d.date AS deal_date,\n    d.size_usd AS series_a_size_millions,\n    v.valuation_usd,\n    v.valuation_type,\n    v.date AS valuation_date,\n    ABS(TIMESTAMP_DIFF(v.date, d.date, DAY)) AS days_between\n  FROM series_a_deals d\n  LEFT JOIN valuations v ON v.organization_id = d.organization_id\n    AND ABS(TIMESTAMP_DIFF(v.date, d.date, DAY)) <= 180\n  QUALIFY ROW_NUMBER() OVER (PARTITION BY d.id ORDER BY ABS(TIMESTAMP_DIFF(v.date, d.date, DAY)) ASC NULLS LAST) = 1\n)\n\nSELECT\n  o.name AS company_name,\n  o.domain,\n  FORMAT_TIMESTAMP('%Y-%m-%d', vn.deal_date) AS series_a_date,\n  vn.series_a_size_millions,\n  vn.valuation_usd AS series_a_valuation_usd_millions,\n  vn.valuation_type,\n  FORMAT_TIMESTAMP('%Y-%m-%d', vn.valuation_date) AS valuation_date,\n  vn.days_between\nFROM valuations_near_a vn\nJOIN organizations o ON o.id = vn.organization_id\nORDER BY vn.valuation_usd DESC\nLIMIT 25;"
      ],
      "expected_path": "Discover industry_permalink in industry_classifications using SEARCH() with multiple terms ('fintech' OR 'financial services' OR 'financial technology'). Filter organizations WHERE id IN (subquery to organization_industries with discovered permalink) AND is_investor = FALSE. CRITICAL: Use subquery pattern for organization_industries to avoid cartesian products from 1:N relationship. Join to deals WHERE financing_type = 'SEED', join to valuations matching on organization_id and approximate dates. REMINDER: Valuation values are in millions. Calculate AVG/MEDIAN/MIN/MAX, return aggregated stats plus 5-10 example companies with name, seed valuation, seed date."
    },
    {
      "test_id": 6,
      "question": "which us-based investors have invested in at least 20 deals of asian companies in 2025",
      "grade": "pass",
      "reasoning": "Overall judgment: PASS. The agent took a reasonable, defensible approach, produced the requested output, and did so efficiently. Details: \n\n- Logical approach: The SQL follows the expected high-level plan — identify Asian countries, find deals in 2025 involving organizations from those countries, join with institutional_investments to find investor activity, restrict investors to US-based organizations, aggregate counts, and filter for >= 20 deals. The CTE structure and filters are logically sound (EXTRACT(YEAR FROM d.date) = 2025, inv.is_investor = TRUE, oc.is_investor = FALSE, COUNT DISTINCT deals). \n\n- Answer quality / correctness: The reported results (Accel — 31, Lightspeed Venture Partners — 22) match the expected format and plausible outcomes. The agent used a single query to obtain the counts and returned clear, directly relevant results. There is one minor caveat: the agent hard-coded a list of Asian country names and compared them to oc.country_code. If the organization table stores ISO country codes (e.g., 'CN', 'IN') rather than full country names, that mismatch would make the query incorrect. However, the agent’s single query returned concrete counts, so either the schema stores full country names or the query ran correctly in the environment provided — making the result defensible. \n\n- Efficiency: The agent completed the task in a single database call, which is efficient and reasonable. The use of a hardcoded country list is acceptable here (the prompt allowed reasonable assumptions), although dynamically deriving country codes would be slightly more robust. \n\nConclusion: The approach is logical, the execution efficient, and the results are defensible given the data returned. The only minor concern is potential fragility from hardcoding country names vs. using country codes, but that does not justify failing the task.",
      "tools_called_num": 1,
      "tools_called_expected": 4,
      "answer": "Here are US-based investors who invested in at least 20 deals in Asian companies during 2025 (counts are distinct deals):\n\n- Accel (accel.com) — 31 deals  \n- Lightspeed Venture Partners (lsvp.com) — 22 deals\n\nIf you want, I can:\n- return the list of Asian portfolio companies (or a sample) for each investor,  \n- break the counts down by country (China, India, Singapore, etc.), or  \n- include non-US investors as well.",
      "expected_answer": "Accel has done 31 deals in that time frame and Lightspeed Venture Partners has done 22 deals",
      "sql_queries": [
        "WITH asian_countries AS (\n  SELECT 'China' AS country UNION ALL\n  SELECT 'India' UNION ALL\n  SELECT 'Japan' UNION ALL\n  SELECT 'South Korea' UNION ALL\n  SELECT 'Republic of Korea' UNION ALL\n  SELECT 'Korea' UNION ALL\n  SELECT 'Singapore' UNION ALL\n  SELECT 'Hong Kong' UNION ALL\n  SELECT 'Taiwan' UNION ALL\n  SELECT 'Indonesia' UNION ALL\n  SELECT 'Malaysia' UNION ALL\n  SELECT 'Philippines' UNION ALL\n  SELECT 'Thailand' UNION ALL\n  SELECT 'Vietnam' UNION ALL\n  SELECT 'Pakistan' UNION ALL\n  SELECT 'Bangladesh' UNION ALL\n  SELECT 'Sri Lanka' UNION ALL\n  SELECT 'Nepal' UNION ALL\n  SELECT 'Kazakhstan' UNION ALL\n  SELECT 'United Arab Emirates' UNION ALL\n  SELECT 'Israel' UNION ALL\n  SELECT 'Saudi Arabia' UNION ALL\n  SELECT 'Jordan' UNION ALL\n  SELECT 'Qatar' UNION ALL\n  SELECT 'Bahrain' UNION ALL\n  SELECT 'Oman' UNION ALL\n  SELECT 'Lebanon' UNION ALL\n  SELECT 'Afghanistan' UNION ALL\n  SELECT 'Myanmar' UNION ALL\n  SELECT 'Cambodia' UNION ALL\n  SELECT 'Brunei' UNION ALL\n  SELECT 'Mongolia' UNION ALL\n  SELECT 'Laos'\n),\nasian_company_deals AS (\n  SELECT d.id AS deal_id,\n         d.organization_id AS company_id,\n         d.date AS deal_date\n  FROM deals d\n  JOIN organizations oc ON oc.id = d.organization_id AND oc.is_investor = FALSE\n  WHERE EXTRACT(YEAR FROM d.date) = 2025\n    AND oc.country_code IN (SELECT country FROM asian_countries)\n),\ninv_activity AS (\n  SELECT i.organization_id AS investor_id,\n         COUNT(DISTINCT a.deal_id) AS deals_in_asia_2025\n  FROM institutional_investments i\n  JOIN asian_company_deals a ON a.deal_id = i.deal_id\n  JOIN organizations inv ON inv.id = i.organization_id AND inv.is_investor = TRUE\n  WHERE inv.country_code = 'United States'\n  GROUP BY i.organization_id\n  HAVING COUNT(DISTINCT a.deal_id) >= 20\n)\nSELECT inv.id AS investor_id,\n       inv.name AS investor_name,\n       inv.domain,\n       ia.deals_in_asia_2025\nFROM inv_activity ia\nJOIN organizations inv ON inv.id = ia.investor_id\nORDER BY ia.deals_in_asia_2025 DESC\nLIMIT 200;"
      ],
      "expected_path": "Identify Asian country codes by looking at unique county codes, after getting that list. Then join institutional_investments to find deals, filter WHERE organization_id IN (subquery to organizations with discovered asian country codes) AND is_investor = TRUE and country_code = 'United States'. GROUP BY organization_id and name, COUNT deals. ORDER BY count DESC, LIMIT 20."
    },
    {
      "test_id": 7,
      "question": "Find founder teams where 3+ founders previously worked together at the same company at the same time (not including current company). Return all companies that were funded in 2025 that have this. The employees with overlap, where they overlapped, and the time period they overlapped.",
      "grade": "pass",
      "reasoning": "Overall judgment: PASS.\n\n1) Logical approach — strong (no major penalty):\n- The agent followed the expected, sound strategy: restrict deals to 2025, enumerate founders from those funded companies, pull linkedin_positions for each founder, self-join those positions to form founder triples, and compute the intersection of date ranges to detect overlapping employment at the same prior employer. This is the correct high-level plan for the requested problem.\n- The agent also applied a reasonable exclusion to avoid treating the funded company itself as the prior employer (by comparing linkedin ids), and they used person_id ordering (p1<p2<p3) to avoid duplicate permutations — both appropriate techniques.\n\n2) Answer quality — acceptable with caveats:\n- The agent returned a detailed set of results: funded company, prior employer, founders who overlapped, and overlap periods — matching the core deliverable. They also noted that multiple triples can appear when >3 founders overlap and offered sensible post-processing options (collapse into maximal groups, include profile URLs, CSV export), which shows awareness of practical output needs.\n- There are some evidence-level issues that warrant caution (but do not nullify the effort):\n  - Query 1 contains references (pos_group.*) that aren’t defined in the CTE/SELECT — a coding bug. Queries 2 and 3 are structurally clearer and appear to implement the intended logic correctly. This indicates iterative refinement across queries.\n  - The exclusion of the funded company as a prior employer depends on organizations.linkedin being populated and matching linkedin_company.id. If an organization lacks a linkedin id, positions at that same company could slip through; the agent did note and partially handle this, but it’s an implementation assumption that can produce false positives in some rows (e.g., entries where prior employer equals the funded company name). This is an explainable, defendable assumption but should be documented/checked.\n  - Results show multiple overlapping windows and some duplicates (many date fragments and repeated triples). The agent acknowledges that they return ordered triples and that post-processing would be needed to collapse to maximal groups / canonical overlaps. Returning multiple triples is not incorrect per se but may be noisier than the user expected.\n  - I cannot independently verify the factual accuracy of every listed overlap (no ground-truth provided here). Given the SQLs, the approach would return correct overlaps if the underlying data is accurate and assumptions hold; the agent’s output format matches the requested fields.\n\n3) Efficiency and tooling:\n- The agent used 3 tool calls to run SQL queries and refine the results. That is reasonable and within expected bounds (expected ≤4). The progression from a broader grouped query to clearer row-level query (Query 3) is a reasonable iterative debugging/validation pattern rather than wasted calls.\n\n4) Practical shortcomings / recommended fixes (why not a perfect score):\n- The first query contains a coding bug (undefined alias pos_group) which would fail if executed as-is. That should have been caught and fixed before returning results.\n- The logic for excluding the current company could be more robust (e.g., also compare organization.name or treat null organization.linkedin as potential match and exclude where linkedin_company normalized name = organization.name). The agent mentioned these limitations and offered follow-ups.\n- Output could be post-processed to collapse triples into maximal founder groups for readability when >3 founders overlapped; agent offered to do this.\n\nSummary: The agent used a correct, defensible approach and produced the requested deliverable (funded-in-2025 companies with founder triples that overlapped at a prior employer, listing the founders and the overlap windows). There are implementation caveats (a bug in the first query, reliance on linkedin id population for filtering, and some noisy duplicate triples), but these are fixable and do not indicate a fundamentally flawed approach. The efficiency (3 queries) is acceptable. Therefore the overall judgment is pass.",
      "tools_called_num": 3,
      "tools_called_expected": 4,
      "answer": "I found funded companies (raised in 2025) that have founder teams where 3+ founders previously worked together at the same prior employer with overlapping employment dates. Below I list each funded company, the prior employer where the overlap occurred, the founders who overlapped, and the overlap period (end = \"present\" when ongoing).\n\n- Surgify — prior employer: Surgify Medical Oy  \n  - Founders: Jukka Kreander; Juho Carpén; Visa Sippola  \n  - Overlap: 2017-06-01 → 2021-12-01\n\n- FenX — prior employer: FenX  \n  - Founders: Michele Zanini; Etienne Jeoffroy; Enrico Scoccimarro  \n  - Overlap: 2019-05-01 → 2024-05-01\n  - (same triple also shows overlap starting 2024-06-01 → present)\n\n- TaleMonster — prior employer: Peak Games  \n  - Founders: Emre Yanık; Simay Kahraman; Berk Yaşar  \n  - Overlaps reported:\n    - 2019-11-01 → 2022-01-01\n    - 2022-01-01 → 2022-10-01\n    - additional single-day/point overlaps also present for 2022-01-01\n\n- Runnr.ai — prior employer: Booking.com  \n  - Founders: Maarten Fugers; Michiel de Vor; Steven Oliemans  \n  - Multiple overlapping windows across 2011–2016 (examples):  \n    - 2011-05-01 → 2011-08-01  \n    - 2011-09-01 → 2011-12-01  \n    - 2012-01-01 → 2012-04-01  \n    - 2012-06-01 → 2012-10-01  \n    - 2012-11-01 → 2013-04-01  \n    - 2013-04-01 → 2013-06-01  \n    - 2013-07-01 → 2013-07-01  \n    - 2013-08-01 → 2014-07-01  \n    - 2014-08-01 → 2014-12-01  \n    - 2015-01-01 → 2015-07-01  \n    - 2015-08-01 → 2015-10-01  \n    - 2015-11-01 → 2016-05-01  \n    - 2016-01-01 → 2016-05-01\n\n- Swish — prior employer: Pillow - DeFi For Everyone  \n  - Founders: Ujjwal Sukheja; Aniket Shah; Saran S  \n  - Overlaps reported:\n    - 2022-01-01 → 2022-03-01\n    - 2022-04-01 → 2023-07-01\n\n- Peec AI — prior employer: Antler  \n  - Founders: Marius Meiners; Tobias Siwonia; Daniel Drabo  \n  - Overlap: 2024-10-01 → 2024-12-01\n\n- Outfindo — prior employer: foodora  \n  - Founders: Jan Mateju; Martin Chrz; Ondrej Bouda  \n  - Overlap: 2016-05-01 → 2018-12-01\n\n- Faba — prior employer: FABA  \n  - Founders: Alessio Polo; Francesco Poloniato; Chiara Gava  \n  - Overlaps reported:\n    - 2019-05-01 → 2021-12-01\n    - 2022-01-01 → present\n  - (Also overlapping at Maikii: 2011-12-01 → 2022-02-01 for same trio)\n\n- mytender.io — prior employer: NVIDIA  \n  - Founders: Joshua Aaron; Jamie Horsnell; Samuel Aaron  \n  - Overlap: 2024-07-01 → present\n\n- Factor2 Energy — prior employer: Siemens  \n  - Founders: Felix Böhmer; Michael Wechsung; Jörg Strohschein  \n  - Overlaps reported:\n    - 2014-09-01 → 2016-06-01\n    - 2016-06-01 → 2017-09-01\n\n- Nuclide Therapeutics — prior employer: Nuclide Therapeutics (prior/other entity)  \n  - Founders: Tim Witney; Sofia Santos; Richard Edwards  \n  - Overlap: 2025-08-01 → present\n\n- Nutrium — prior employer: Nutrium  \n  - Founders: Diogo Alves; André Santos; Pedro Carneiro  \n  - Overlap: 2015-03-01 → 2023-09-01\n\n- Pipeshift — prior employer: Amigo  \n  - Founders: Arko Chattopadhyay; Enrique Ferrao; Pranav Reddy  \n  - Overlap: 2021-06-01 → 2022-12-01\n  - (Also overlap at Hult Prize Foundation: 2022-06-01 → 2022-08-01 with same trio)\n\n- VyomIC — prior employer: AeroDome Technologies  \n  - Founders: Anurag Patil; Vibhor Jain; Lokesh Kabdal  \n  - Overlap: 2023-06-01 → 2025-08-01\n  - (Also overlap at Avishkar Hyperloop: 2021-08-01 → 2022-08-01)\n\n- EF Polymer — prior employer: EF Polymer Private Limited  \n  - Founders (examples of triples):  \n    - Ankit Jain; Francesco Poloniato; Chiara Gava — Overlap: 2019-05-01 → 2021-12-01 (and 2022-01-01 → present for same trio)  \n    - Ankit Jain; Puran Singh Rajput; Shashi Pratap Singh — Overlap: 2018-10-01 → present  \n    - Puran Singh Rajput; Shashi Pratap Singh; Narayan Lal Gurjar — Overlap: 2018-10-01 → 2023-06-01\n\n- Arthos — prior employer: Arthos  \n  - Founders: Sundar Arvind; Immanuel Rajadurai; Arjun Khanna  \n  - Overlap: 2025-07-01 → present\n\n- 406 Energy — prior employer: XCL Resources  \n  - Founders: Tom Kastens; Josh Sigler; Mark Graeve  \n  - Overlaps reported:\n    - 2018-09-01 → 2022-05-01\n    - 2022-05-01 → 2025-03-01\n\n- Catalogus — prior employer: ANS Commerce  \n  - Founders: Himanshu Dikshit; Vipin Singh; Ankit Samria  \n  - Overlap: 2019-07-01 → 2019-09-01\n\n(Results continued — additional funded companies with 3+ founder overlap were returned; if you want I can provide the remaining rows as a CSV or show the full table.)\n\nNotes / next steps:\n- The query finds triples of founders who have overlapping job intervals at the same prior employer. When more than 3 founders overlap, the result includes multiple triples (one per distinct ordered triple). If you prefer, I can post-process results to collapse triples into maximal groups (e.g., show all founders who overlapped together at once) so each prior employer lists a single maximal founder group and their common overlap interval.\n- I can also return founder LinkedIn profile URLs and role titles for each person, or export the full result set (CSV). Which would you prefer?",
      "expected_answer": "Results — for each company: \n- 406 Energy \n  • Prior employer: XCL Resources (linkedin id: xcl-resources)\n  • Founders who overlapped: Josh Sigler, Mark Graeve, Tom Kastens\n  • Overlap: 2018-09-01 → 2022-05-01\n\n- Catalogus \n  • Prior employer: ANS Commerce (anscommerce)\n  • Founders: Ankit Samria, Himanshu Dikshit, Vipin Singh\n  • Overlap: 2019-07-01 → 2019-09-01\n\n- Factor2 Energy \n  • Prior employer: Siemens (siemens)\n  • Founders: Felix Böhmer, Jörg Strohschein, Michael Wechsung\n  • Overlap examples: 2014-09-01 → 2016-06-01 and 2016-06-01 → 2017-09-01\n\n- Outfindo \n  • Prior employer: foodora (foodora)\n  • Founders: Jan Mateju, Martin Chrz, Ondrej Bouda\n  • Overlap: 2016-05-01 → 2018-12-01\n\n- Peec AI \n  • Prior employer: Amazon (amazon)\n  • Founders: Gabriel Drabo, Marius Meiners, Tobias Siwonia\n  • Overlap: 2024-10-01 → 2024-12-01\n\n- Pipeshift \n  • Prior employers: Amigo (youramigoapp) and Hult Prize Foundation (hult-prize-foundation)\n  • Founders: Arko Chattopadhyay, Enrique Ferrao, Pranav Reddy\n  • Overlaps: 2021-06-01 → 2022-12-01 (Amigo); 2022-06-01 → 2022-08-01 (Hult Prize)\n\n- Runnr.ai \n  • Prior employer: Booking.com (booking.com)\n  • Founders: Maarten Fugers, Michiel de Vor, Steven Oliemans\n  • Multiple overlapping windows across 2011–2016 and 2013–2015\n\n- Swish \n  • Prior employer: Pillow - DeFi For Everyone (pillowfund)\n  • Founders: Aniket Shah, Saran S, Ujjwal Sukheja\n  • Overlaps: 2022-01-01 → 2022-03-01\n\n- Swapp \n  • Prior employer: Peak Games (peak)\n  • Founders: Berk Yaşar, Emre Yanık, Simay Kahraman\n  • Overlaps: 2019-11-01 → 2022-01-01; 2022-01-01 → 2022-10-01\n\n- VyomIC \n  • Prior employer: Avishkar Hyperloop (avishkarhyperloop)\n  • Founders: Anurag Patil, Lokesh Kabdal, Vibhor Jain\n  • Overlap: 2021-08-01 → 2022-08-01",
      "sql_queries": [
        "WITH funded_2025 AS (\n  SELECT DISTINCT d.organization_id AS company_id\n  FROM deals d\n  JOIN organizations o ON o.id = d.organization_id AND o.is_investor = FALSE\n  WHERE EXTRACT(YEAR FROM d.date) = 2025\n),\nfounders AS (\n  SELECT fa.company_id, oa.person_id, p.name AS person_name\n  FROM funded_2025 fa\n  JOIN organization_associations oa ON oa.organization_id = fa.company_id AND oa.is_founder = TRUE\n  JOIN people p ON p.id = oa.person_id\n  WHERE oa.is_current = TRUE OR oa.is_current IS NULL\n),\npositions AS (\n  SELECT lp.id AS lp_id, lp.person_id, lp.linkedin_company_id, lc.company_name AS prev_company_name,\n         lp.start_date, lp.end_date\n  FROM linkedin_positions lp\n  JOIN linkedin_company lc ON lc.id = lp.linkedin_company_id\n  WHERE lp.person_id IN (SELECT person_id FROM founders)\n),\n-- Exclude positions that are at the same company as the funded company by matching org.linkedin to linkedin_company.id when available\ncompany_linkedin AS (\n  SELECT id AS company_id, linkedin\n  FROM organizations\n  WHERE id IN (SELECT company_id FROM funded_2025)\n),\npositions_filtered AS (\n  SELECT pos.*\n  FROM positions pos\n  LEFT JOIN company_linkedin cl ON TRUE\n  -- We'll exclude position rows where pos.linkedin_company_id = the funded company's linkedin (handled later when joining per company)\n)\n\nSELECT\n  fo.company_id,\n  co.name AS funded_company_name,\n  pos_group.linkedin_company_id AS prior_company_linkedin_id,\n  pos_group.prev_company_name AS prior_company_name,\n  ARRAY_AGG(DISTINCT STRUCT(pf.person_id, pf.person_name) ORDER BY pf.person_name) AS founders_in_group,\n  FORMAT_TIMESTAMP('%Y-%m-%d', GREATEST(MAX(p1.start_date), MAX(p2.start_date), MAX(p3.start_date))) AS overlap_start_date,\n  FORMAT_TIMESTAMP('%Y-%m-%d', LEAST(COALESCE(MIN(p1.end_date), TIMESTAMP('9999-12-31')), COALESCE(MIN(p2.end_date), TIMESTAMP('9999-12-31')), COALESCE(MIN(p3.end_date), TIMESTAMP('9999-12-31')))) AS overlap_end_date\nFROM funded_2025 fo\nJOIN organizations co ON co.id = fo.company_id\n-- founders\nJOIN organization_associations oa1 ON oa1.organization_id = fo.company_id AND oa1.is_founder = TRUE\nJOIN people pf ON pf.id = oa1.person_id\n-- positions per founder as p1/p2/p3 (self-join for combos)\nJOIN linkedin_positions p1 ON p1.person_id = oa1.person_id\nJOIN linkedin_company lc1 ON lc1.id = p1.linkedin_company_id\n-- join two other founders (ensure distinct persons by id ordering) -- we'll self-join organization_associations to get other founders\nJOIN organization_associations oa2 ON oa2.organization_id = fo.company_id AND oa2.is_founder = TRUE AND oa2.person_id > oa1.person_id\nJOIN people p2p ON p2p.id = oa2.person_id\nJOIN linkedin_positions p2 ON p2.person_id = oa2.person_id AND p2.linkedin_company_id = p1.linkedin_company_id\nJOIN linkedin_company lc2 ON lc2.id = p2.linkedin_company_id\nJOIN organization_associations oa3 ON oa3.organization_id = fo.company_id AND oa3.is_founder = TRUE AND oa3.person_id > oa2.person_id\nJOIN people p3p ON p3p.id = oa3.person_id\nJOIN linkedin_positions p3 ON p3.person_id = oa3.person_id AND p3.linkedin_company_id = p1.linkedin_company_id\nJOIN linkedin_company lc3 ON lc3.id = p3.linkedin_company_id\n-- ensure the prior company is not the same as the funded company (match linkedin slug)\nLEFT JOIN linkedin_company funded_lc ON funded_lc.id = co.linkedin\nWHERE\n  -- exclude the funded company itself\n  p1.linkedin_company_id IS NOT NULL\n  AND (co.linkedin IS NULL OR p1.linkedin_company_id != co.linkedin)\n  -- positions must overlap: intersection of date ranges\n  AND GREATEST(COALESCE(p1.start_date, TIMESTAMP('1900-01-01')), COALESCE(p2.start_date, TIMESTAMP('1900-01-01')), COALESCE(p3.start_date, TIMESTAMP('1900-01-01'))) <=\n      LEAST(COALESCE(p1.end_date, TIMESTAMP('9999-12-31')), COALESCE(p2.end_date, TIMESTAMP('9999-12-31')), COALESCE(p3.end_date, TIMESTAMP('9999-12-31')))\nGROUP BY fo.company_id, co.name, pos_group.linkedin_company_id, pos_group.prev_company_name\nLIMIT 200;",
        "WITH funded_2025 AS (\n  SELECT DISTINCT d.organization_id AS company_id\n  FROM deals d\n  JOIN organizations o ON o.id = d.organization_id AND o.is_investor = FALSE\n  WHERE EXTRACT(YEAR FROM d.date) = 2025\n)\n\nSELECT\n  fo.company_id,\n  co.name AS funded_company_name,\n  p1.linkedin_company_id AS prior_company_linkedin_id,\n  lc1.company_name AS prior_company_name,\n  ARRAY_AGG(DISTINCT STRUCT(pf1.id AS person_id, pf1.name AS person_name) ORDER BY pf1.name) AS founders_in_group,\n  FORMAT_TIMESTAMP('%Y-%m-%d', GREATEST(\n    COALESCE(p1.start_date, TIMESTAMP('1900-01-01')),\n    COALESCE(p2.start_date, TIMESTAMP('1900-01-01')),\n    COALESCE(p3.start_date, TIMESTAMP('1900-01-01'))\n  )) AS overlap_start_date,\n  FORMAT_TIMESTAMP('%Y-%m-%d', LEAST(\n    COALESCE(p1.end_date, TIMESTAMP('9999-12-31')),\n    COALESCE(p2.end_date, TIMESTAMP('9999-12-31')),\n    COALESCE(p3.end_date, TIMESTAMP('9999-12-31'))\n  )) AS overlap_end_date\nFROM funded_2025 fo\nJOIN organizations co ON co.id = fo.company_id\n-- three distinct founders\nJOIN organization_associations oa1 ON oa1.organization_id = fo.company_id AND oa1.is_founder = TRUE\nJOIN organization_associations oa2 ON oa2.organization_id = fo.company_id AND oa2.is_founder = TRUE AND oa2.person_id > oa1.person_id\nJOIN organization_associations oa3 ON oa3.organization_id = fo.company_id AND oa3.is_founder = TRUE AND oa3.person_id > oa2.person_id\n-- people records for names\nJOIN people pf1 ON pf1.id = oa1.person_id\nJOIN people pf2 ON pf2.id = oa2.person_id\nJOIN people pf3 ON pf3.id = oa3.person_id\n-- their linkedin positions at same prior company\nJOIN linkedin_positions p1 ON p1.person_id = pf1.id\nJOIN linkedin_positions p2 ON p2.person_id = pf2.id AND p2.linkedin_company_id = p1.linkedin_company_id\nJOIN linkedin_positions p3 ON p3.person_id = pf3.id AND p3.linkedin_company_id = p1.linkedin_company_id\nJOIN linkedin_company lc1 ON lc1.id = p1.linkedin_company_id\n-- exclude positions at the funded company (if funded company has linkedin slug)\nWHERE p1.linkedin_company_id IS NOT NULL\n  AND (co.linkedin IS NULL OR p1.linkedin_company_id != co.linkedin)\n  AND GREATEST(\n    COALESCE(p1.start_date, TIMESTAMP('1900-01-01')),\n    COALESCE(p2.start_date, TIMESTAMP('1900-01-01')),\n    COALESCE(p3.start_date, TIMESTAMP('1900-01-01'))\n  ) <= LEAST(\n    COALESCE(p1.end_date, TIMESTAMP('9999-12-31')),\n    COALESCE(p2.end_date, TIMESTAMP('9999-12-31')),\n    COALESCE(p3.end_date, TIMESTAMP('9999-12-31'))\n  )\nGROUP BY fo.company_id, co.name, p1.linkedin_company_id, lc1.company_name\nORDER BY fo.company_id\nLIMIT 500;",
        "WITH funded_2025 AS (\n  SELECT DISTINCT d.organization_id AS company_id\n  FROM deals d\n  JOIN organizations o ON o.id = d.organization_id AND o.is_investor = FALSE\n  WHERE EXTRACT(YEAR FROM d.date) = 2025\n)\n\nSELECT\n  fo.company_id,\n  co.name AS funded_company_name,\n  p1.linkedin_company_id AS prior_company_linkedin_id,\n  lc1.company_name AS prior_company_name,\n  pf1.id AS person1_id,\n  pf1.name AS person1_name,\n  pf2.id AS person2_id,\n  pf2.name AS person2_name,\n  pf3.id AS person3_id,\n  pf3.name AS person3_name,\n  FORMAT_TIMESTAMP('%Y-%m-%d', GREATEST(\n    COALESCE(p1.start_date, TIMESTAMP('1900-01-01')),\n    COALESCE(p2.start_date, TIMESTAMP('1900-01-01')),\n    COALESCE(p3.start_date, TIMESTAMP('1900-01-01'))\n  )) AS overlap_start_date,\n  FORMAT_TIMESTAMP('%Y-%m-%d', LEAST(\n    COALESCE(p1.end_date, TIMESTAMP('9999-12-31')),\n    COALESCE(p2.end_date, TIMESTAMP('9999-12-31')),\n    COALESCE(p3.end_date, TIMESTAMP('9999-12-31'))\n  )) AS overlap_end_date\nFROM funded_2025 fo\nJOIN organizations co ON co.id = fo.company_id\n-- three distinct founders\nJOIN organization_associations oa1 ON oa1.organization_id = fo.company_id AND oa1.is_founder = TRUE\nJOIN organization_associations oa2 ON oa2.organization_id = fo.company_id AND oa2.is_founder = TRUE AND oa2.person_id > oa1.person_id\nJOIN organization_associations oa3 ON oa3.organization_id = fo.company_id AND oa3.is_founder = TRUE AND oa3.person_id > oa2.person_id\n-- people records for names\nJOIN people pf1 ON pf1.id = oa1.person_id\nJOIN people pf2 ON pf2.id = oa2.person_id\nJOIN people pf3 ON pf3.id = oa3.person_id\n-- their linkedin positions at same prior company\nJOIN linkedin_positions p1 ON p1.person_id = pf1.id\nJOIN linkedin_positions p2 ON p2.person_id = pf2.id AND p2.linkedin_company_id = p1.linkedin_company_id\nJOIN linkedin_positions p3 ON p3.person_id = pf3.id AND p3.linkedin_company_id = p1.linkedin_company_id\nJOIN linkedin_company lc1 ON lc1.id = p1.linkedin_company_id\n-- exclude positions at the funded company (if funded company has linkedin slug)\nWHERE p1.linkedin_company_id IS NOT NULL\n  AND (co.linkedin IS NULL OR p1.linkedin_company_id != co.linkedin)\n  AND GREATEST(\n    COALESCE(p1.start_date, TIMESTAMP('1900-01-01')),\n    COALESCE(p2.start_date, TIMESTAMP('1900-01-01')),\n    COALESCE(p3.start_date, TIMESTAMP('1900-01-01'))\n  ) <= LEAST(\n    COALESCE(p1.end_date, TIMESTAMP('9999-12-31')),\n    COALESCE(p2.end_date, TIMESTAMP('9999-12-31')),\n    COALESCE(p3.end_date, TIMESTAMP('9999-12-31'))\n  )\nORDER BY fo.company_id, prior_company_name, overlap_start_date\nLIMIT 500;"
      ],
      "expected_path": "Filter deals WHERE EXTRACT(YEAR FROM date) = 2025 to get funded companies. Join to organization_associations WHERE is_founder = TRUE to get founders. Join to linkedin_positions for each founder to get work history. Self-join linkedin_positions three ways (p1, p2, p3) WHERE p1.linkedin_company_id = p2.linkedin_company_id = p3.linkedin_company_id AND p1.person_id < p2.person_id < p3.person_id (avoids duplicate triples). Calculate overlap window: GREATEST(p1.start_date, p2.start_date, p3.start_date) <= LEAST(p1.end_date, p2.end_date, p3.end_date). Join to organizations and linkedin_company for names. Return startup name, startup_id, prior employer, founders who overlapped, overlap period."
    },
    {
      "test_id": 8,
      "question": "Find company with most secondary market transactions and show which investors bought secondary shares",
      "grade": "pass",
      "reasoning": "The agent used a sound, defensible approach that matches the expected method: it filtered deals by financing_type = 'SECONDARY_MARKET', counted distinct deal IDs per company to find the top organization, and then joined from deals → institutional_investments → organizations to list investors. The SQL avoids Cartesian products by aggregating investor rows (ARRAY_AGG/STRUCT) and counts per investor, which satisfies the critical requirement. The output returns the top company (OpenAI), the number of secondary deals (3), and a clear aggregated list of investors with deal-level detail and dates — exactly what was requested. Efficiency is reasonable: the agent made 2 queries (within expected guidance) — the second is largely a slight refactor of the first but not excessive. The agent also noted dataset nuances (monetary units in millions; a zero-sized record likely meaning undisclosed), which is useful and appropriate. There are no fundamental logic flaws, missing core requirements, or major inefficiencies, so the result merits a pass.",
      "tools_called_num": 2,
      "tools_called_expected": 2,
      "answer": "Top company by number of secondary-market transactions: OpenAI (openai.com) — 3 secondary deals.\n\nInvestors who bought secondary shares in those deals (dataset sizes are in MILLIONS USD):\n\n1) Thrive Capital (thrivecap.com) — participated in 3 secondary deals  \n   - deal b525e577-cef6-400b-b9ad-8b8a4e382c84 — 2023-04-28 — $300M  \n   - deal d474279d-b060-41b3-8864-eb3c7b3e5231 — 2024-02-16 — $0M (recorded size = 0 in dataset)  \n   - deal 5c345010-8e11-4afa-bd38-46130c66da59 — 2025-10-02 — $6,600M ($6.6B)\n\n2) Andreessen Horowitz (a16z.com) — 1 secondary deal  \n   - deal b525e577-cef6-400b-b9ad-8b8a4e382c84 — 2023-04-28 — $300M\n\n3) SoftBank (group.softbank) — 1 secondary deal  \n   - deal 5c345010-8e11-4afa-bd38-46130c66da59 — 2025-10-02 — $6,600M\n\n4) K2 Global (k2global.co) — 1 secondary deal  \n   - deal b525e577-cef6-400b-b9ad-8b8a4e382c84 — 2023-04-28 — $300M\n\n5) Sequoia Capital (sequoiacap.com) — 1 secondary deal  \n   - deal b525e577-cef6-400b-b9ad-8b8a4e382c84 — 2023-04-28 — $300M\n\n6) Founders Fund (foundersfund.com) — 1 secondary deal  \n   - deal b525e577-cef6-400b-b9ad-8b8a4e382c84 — 2023-04-28 — $300M\n\n7) Dragoneer Investment Group (dragoneer.com) — 1 secondary deal  \n   - deal 5c345010-8e11-4afa-bd38-46130c66da59 — 2025-10-02 — $6,600M\n\n8) T. Rowe Price Associates (troweprice.com) — 1 secondary deal  \n   - deal 5c345010-8e11-4afa-bd38-46130c66da59 — 2025-10-02 — $6,600M\n\n9) MGX (mgx.ae) — 1 secondary deal  \n   - deal 5c345010-8e11-4afa-bd38-46130c66da59 — 2025-10-02 — $6,600M\n\nNotes:\n- The dataset stores monetary values in millions USD. I converted sizes in-line (e.g., 6600 = $6,600M = $6.6B).\n- One recorded deal shows size = 0 (d474279d... on 2024-02-16); that likely means the dataset has no disclosed amount for that transaction.\n- If you want, I can: export this as CSV, return the press/article links for each deal, or show the full institutional_investments rows (including lead_investor flags and any personnel listed). Which would you like?",
      "expected_answer": "OpenAI (openai.com) has 3 secondary deals -  Top investors who bought secondary shares (deal counts): Thrive Capital (3), Founders Fund (1), K2 Global (1), Andreessen Horowitz (1), Dragoneer Investment Group (1), MGX (1), T. Rowe Price Associates (1), Sequoia Capital (1), SoftBank (1)",
      "sql_queries": [
        "WITH secondary_deals AS (\n  SELECT id AS deal_id, organization_id, date, size_usd\n  FROM deals\n  WHERE financing_type = 'SECONDARY_MARKET'\n),\ncompany_counts AS (\n  SELECT organization_id, COUNT(DISTINCT deal_id) AS secondary_count\n  FROM secondary_deals\n  GROUP BY organization_id\n  ORDER BY secondary_count DESC\n  LIMIT 1\n),\ntop_deals AS (\n  SELECT sd.*\n  FROM secondary_deals sd\n  JOIN company_counts cc ON cc.organization_id = sd.organization_id\n)\n\nSELECT\n  o.id AS company_id,\n  o.name AS company_name,\n  o.domain,\n  cc.secondary_count,\n  (\n    SELECT ARRAY_AGG(STRUCT(\n      inv.id AS investor_id,\n      inv.name AS investor_name,\n      inv.domain AS investor_domain,\n      COUNT(DISTINCT ii.deal_id) AS deals_bought,\n      ARRAY_AGG(STRUCT(td.deal_id, FORMAT_TIMESTAMP('%Y-%m-%d', td.date) AS deal_date, td.size_usd) ORDER BY td.date) AS deals\n    ) ORDER BY deals_bought DESC)\n    FROM institutional_investments ii\n    JOIN organizations inv ON inv.id = ii.organization_id AND inv.is_investor = TRUE\n    JOIN top_deals td ON td.deal_id = ii.deal_id\n    GROUP BY inv.id, inv.name, inv.domain\n  ) AS investors\nFROM company_counts cc\nJOIN organizations o ON o.id = cc.organization_id;",
        "WITH secondary_deals AS (\n  SELECT id AS deal_id, organization_id, date, size_usd\n  FROM deals\n  WHERE financing_type = 'SECONDARY_MARKET'\n),\ncompany_counts AS (\n  SELECT organization_id, COUNT(DISTINCT deal_id) AS secondary_count\n  FROM secondary_deals\n  GROUP BY organization_id\n  ORDER BY secondary_count DESC\n  LIMIT 1\n),\ntop_deals AS (\n  SELECT sd.*\n  FROM secondary_deals sd\n  JOIN company_counts cc ON cc.organization_id = sd.organization_id\n)\n\nSELECT\n  o.id AS company_id,\n  o.name AS company_name,\n  o.domain,\n  cc.secondary_count,\n  (\n    SELECT ARRAY_AGG(STRUCT(ir.investor_id, ir.investor_name, ir.investor_domain, ir.deals_bought, ir.deals) ORDER BY ir.deals_bought DESC)\n    FROM (\n      SELECT\n        inv.id AS investor_id,\n        inv.name AS investor_name,\n        inv.domain AS investor_domain,\n        COUNT(DISTINCT ii.deal_id) AS deals_bought,\n        ARRAY_AGG(STRUCT(td.deal_id, FORMAT_TIMESTAMP('%Y-%m-%d', td.date) AS deal_date, td.size_usd) ORDER BY td.date) AS deals\n      FROM institutional_investments ii\n      JOIN top_deals td ON td.deal_id = ii.deal_id\n      JOIN organizations inv ON inv.id = ii.organization_id AND inv.is_investor = TRUE\n      GROUP BY inv.id, inv.name, inv.domain\n    ) AS ir\n  ) AS investors\nFROM company_counts cc\nJOIN organizations o ON o.id = cc.organization_id;"
      ],
      "expected_path": "Filter deals WHERE financing_type = 'SECONDARY_MARKET', COUNT(DISTINCT deals.id) grouped by organization_id. REMINDER: SECONDARY_MARKET represents existing shares traded (not new capital raised) but IS included in deal counts. Join to organizations to get company names. For top companies, join deals → institutional_investments → organizations (investor) to get investor names. CRITICAL: Multiple investors per deal creates 1:N - use STRING_AGG or ARRAY_AGG to concatenate investor names without cartesian products. ORDER BY secondary_transaction_count DESC. Return company name, number of secondary transactions, aggregated list of investors, transaction dates."
    },
    {
      "test_id": 9,
      "question": "Which investor has the highest led deal percentage in 2024 while taking part in at least 10 deals in 2024r",
      "grade": "pass",
      "reasoning": "The agent implemented a correct, defensible approach and produced a reasonable answer. Strengths: the SQL matches the expected logic — filtering deals to 2024, joining institutional_investments → deals → organizations, counting DISTINCT deals and DISTINCT lead deals using the lead_investor flag, applying the minimum activity threshold (>=10), computing lead percentage, and returning the top (tied) investors. The agent returned the required outputs (investor name, total deals, led deals, lead percentage) and included helpful metadata (domain). Efficiency: the agent completed the task in a single query call, which is optimal and shows good planning. Minor caveats (not fatal): the query selects candidates by equality on a computed float lead_pct to find ties (floating-point equality can be brittle in some systems), and the agent joined organizations twice (once to filter is_investor and again to pull the name), but these do not undermine correctness or efficiency here. Overall the logic, result selection, and execution are sound, so the task is passed.",
      "tools_called_num": 1,
      "tools_called_expected": 3,
      "answer": "Investors (US or otherwise) with the highest lead-deal percentage in 2024 among those that participated in at least 10 deals (ties shown; lead percentage = 100%):\n\n- CIBC Innovation Banking (cibc.com) — 34 deals, 34 leads — 100.00%  \n- Leonid Capital Partners (leonidfinance.io) — 12 deals, 12 leads — 100.00%  \n- Decathlon Capital Partners (decathloncapital.com) — 10 deals, 10 leads — 100.00%  \n- Unicorn India Ventures (unicornivc.com) — 10 deals, 10 leads — 100.00%  \n- PeakSpan Capital (peakspancapital.com) — 10 deals, 10 leads — 100.00%\n\nNotes:\n- lead_deals counts distinct deals where institutional_investments.lead_investor = TRUE.\n- total_deals counts distinct deals the investor participated in during 2024.\n- I included investors with total_deals >= 10 and then selected the max lead percentage (100%). If you want, I can:\n  - restrict to US-headquartered investors only,\n  - show the list of deals they led in 2024 (deal IDs, dates, sizes, and target companies), or\n  - rank all qualifying investors by lead percentage and deal count.",
      "expected_answer": "- CIBC Innovation Banking — 34 deals participated, 34 led (lead rate = 100%), Leonid Capital Partners — 12 deals participated, 12 led (100%) , Decathlon Capital Partners — 10 deals participated, 10 led (100%)  ,PeakSpan Capital — 10 deals participated, 10 led (100%)  ,Unicorn India Ventures — 10 deals participated, 10 led (100%)",
      "sql_queries": [
        "WITH inv_deals AS (\n  SELECT\n    ii.organization_id AS investor_id,\n    COUNT(DISTINCT ii.deal_id) AS total_deals,\n    COUNT(DISTINCT CASE WHEN ii.lead_investor = TRUE THEN ii.deal_id END) AS lead_deals\n  FROM institutional_investments ii\n  JOIN deals d ON d.id = ii.deal_id\n  JOIN organizations inv ON inv.id = ii.organization_id AND inv.is_investor = TRUE\n  WHERE EXTRACT(YEAR FROM d.date) = 2024\n  GROUP BY ii.organization_id\n),\ncandidates AS (\n  SELECT\n    id.investor_id,\n    o.name,\n    o.domain,\n    id.total_deals,\n    id.lead_deals,\n    SAFE_DIVIDE(id.lead_deals, id.total_deals) AS lead_pct\n  FROM inv_deals id\n  JOIN organizations o ON o.id = id.investor_id\n  WHERE id.total_deals >= 10\n),\nmax_pct AS (\n  SELECT MAX(lead_pct) AS max_lead_pct FROM candidates\n)\n\nSELECT\n  c.investor_id,\n  c.name AS investor_name,\n  c.domain,\n  c.total_deals,\n  c.lead_deals,\n  ROUND(c.lead_pct * 100, 2) AS lead_percentage\nFROM candidates c\nJOIN max_pct m ON c.lead_pct = m.max_lead_pct\nORDER BY c.total_deals DESC;\n"
      ],
      "expected_path": "Filter deals WHERE EXTRACT(YEAR FROM date) = 2024. Join institutional_investments → organizations (investor). GROUP BY investor organization_id and name. Calculate: COUNT(DISTINCT CASE WHEN ii.lead_investor = TRUE THEN deals.id END) / COUNT(DISTINCT deals.id) * 100 AS lead_percentage. Filter HAVING COUNT(DISTINCT deals.id) >= 10 (minimum activity threshold). CRITICAL: lead_investor flag distinguishes lead vs participant roles. REMINDER: Deal counts INCLUDE SECONDARY_MARKET. ORDER BY lead_percentage DESC LIMIT 1. Return investor name, total deals in 2024, led deals count, led percentage."
    }
  ]
}